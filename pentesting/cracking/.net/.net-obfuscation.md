# .NET Obfuscation

### Packer

#### **Signature**&#x20;

Lots of arrays in `.cctor` module

<figure><img src="../../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

#### **Antidote**&#x20;

1. Set Breakpoint on `gchandle.free`

<figure><img src="../../../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

2. Click Start to run debugger, then click OK

<figure><img src="../../../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

3. If Modules tab is not shown, you can open it by clicking on **Debug** -> **Windows** -> **Modules**. koi.exe should now be shown in the Modules tab

<figure><img src="../../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

4. Right click on koi and select **Save Module** and save the file somewhere on the file system

<figure><img src="../../../.gitbook/assets/image (4) (1).png" alt=""><figcaption></figcaption></figure>

5. Take the newly unpacked `koi.exe` and open it in the debugger
6. Right click on **koi** module and select **Edit Module**

<figure><img src="../../../.gitbook/assets/image (5) (1).png" alt=""><figcaption></figcaption></figure>

7. Change the **Entry Point** to be **Managed** then select the box next to Managed

<figure><img src="../../../.gitbook/assets/image (7) (1).png" alt=""><figcaption></figcaption></figure>

8. Open the program and fine the Main function. Click **OK** then click **OK** again

<figure><img src="../../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

9. Right click and select **Remove** for  the module

<figure><img src="../../../.gitbook/assets/image (9).png" alt=""><figcaption></figcaption></figure>

10. When prompted click Yes to save the file somewhere on the file system



<figure><img src="../../../.gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>

### Anti Tamper

#### Signature

An exception occurred when decompiling this method (06000005)

<figure><img src="../../../.gitbook/assets/image (113).png" alt=""><figcaption></figcaption></figure>

EntryPoint VirtualProtect in cctor. Also same with Anti-Dump protection, but Anti-Dump has visible contents within functions.&#x20;

<figure><img src="../../../.gitbook/assets/image (114).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (115).png" alt=""><figcaption></figcaption></figure>

#### **Antidote**&#x20;

1. Set breakpoint on module static

<figure><img src="../../../.gitbook/assets/image (116).png" alt=""><figcaption></figcaption></figure>

2. Click Start then OK to run.&#x20;

<figure><img src="../../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

3. Go to Debug -> Step Over

<figure><img src="../../../.gitbook/assets/image (118).png" alt=""><figcaption></figcaption></figure>

3. &#x20;Click on the Modules tab then right click on the Anti-Tampering exe file and select **Save Module**

<figure><img src="../../../.gitbook/assets/image (119).png" alt=""><figcaption></figcaption></figure>

4. Open the dumped module in dnSpy. Navigate to the static module

<figure><img src="../../../.gitbook/assets/image (120).png" alt=""><figcaption></figcaption></figure>

5. Right click on the Instruction and select **Edit IL Instructions...**

<figure><img src="../../../.gitbook/assets/image (121).png" alt=""><figcaption></figcaption></figure>

6. Right click then select **NOP Instruction** then click **OK**

<figure><img src="../../../.gitbook/assets/image (122).png" alt=""><figcaption></figcaption></figure>

7. Right click and remove file. When prompted click **Yes** to save it

![](<../../../.gitbook/assets/image (123).png>)
