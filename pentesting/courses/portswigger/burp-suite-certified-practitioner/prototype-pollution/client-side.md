# Client-side

In this section, you'll learn how to find client-side prototype pollution vulnerabilities in the wild. To help solidify your understanding of how these vulnerabilities work, we'll cover how to do this manually, as well as how you can use DOM Invader to automate much of this process. You'll also have the chance to practice what you've learned by exploiting prototype pollution for DOM XSS on some deliberately vulnerable labs.&#x20;

## Finding sources manually <a href="#finding-client-side-prototype-pollution-sources-manually" id="finding-client-side-prototype-pollution-sources-manually"></a>

Finding prototype pollution sources manually is largely a case of trial and error. In short, you need to try different ways of adding an arbitrary property to Object.prototype until you find a source that works.&#x20;

When testing for client-side vulnerabilities, this involves the following high-level steps:&#x20;

1. Try to inject an arbitrary property via the query string, URL fragment, and any JSOn input. For example:

`vulnerable-website.com/?__proto__[foo]=bar`

2. In your browser console, inspect `Object.prototype` to see if you have successfully polluted it with your arbitrary property:&#x20;

```javascript
Object.prototype.foo
// "bar" indicates that you have successfully polluted the prototype
// undefined indicates that the attack was not successful
```

3. If the property was not added to the prototype, try using different techniques, such as switching to dot notation rather than bracket notation, or vice versa:

`vulnerable-website.com/?__proto__.foo=bar`

4. Repeat this process for each potential source

## Find sources using DOM Invader

As you can see from the steps above, manually identifying prototype pollution gadgets in the wild can be a laborious task. Given the websites often rely on a number of third-party libraries, this may involve reading through thousands of lines of minified or obfuscated code, which makes things even trickier. DOM Invader can automatically scan for gadgets on your behalf and can even generate a DOM XSS proof-of-concept in some ccases. This means you can find exploits on real-world sites in a matter of seconds rather hours.&#x20;

For more information, check out the DOM Invader documentation.

{% embed url="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution#scanning-for-prototype-pollution-gadgets" %}

