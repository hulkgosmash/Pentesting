# Corridor

<figure><img src="../../../../.gitbook/assets/04afd126bf7a729eec5ff41e5b9b1212.png" alt=""><figcaption><p>Corridor</p></figcaption></figure>

You have found yourself in a strange corridor. Can you find your way back to where you came?\


In this challenge, you will explore potential IDOR vulnerabilities. Examine the URL endpoints you access as you navigate the website and note the hexadecimal values you find (they look an awful lot like a _hash_, don't they?). This could help you uncover website locations you were not expected to access.

## Enumeration

Navigating to the webpage we see a bunch of doors no doubt in reference to the IDOR vulnerability mentioned in the description.&#x20;

<figure><img src="../../../../.gitbook/assets/image (5) (1).png" alt=""><figcaption><p>Webpage</p></figcaption></figure>

Each of the doors has a link to a subdirectory which looks like the image below however each of the links are different.&#x20;

<figure><img src="../../../../.gitbook/assets/image (21) (1).png" alt=""><figcaption><p>Linked page</p></figcaption></figure>

As hinted the links appear to be some kind of hash. Using hash-identifier we can identify the hash type as being MD5.&#x20;

```bash
hash-identifier
c4ca4238a0b923820dcc509a6f75849b
```

<figure><img src="../../../../.gitbook/assets/image (1) (2) (1).png" alt=""><figcaption><p>hash-identifier</p></figcaption></figure>

We can extract all of the links from the webpage using `curl`, `grep` & `cut`.&#x20;

```
curl $ip | grep 'area target' | cut -d " " -f 11 | cut -d "\"" -f 2
```

<figure><img src="../../../../.gitbook/assets/image (15) (1).png" alt=""><figcaption><p>Extract hashes from links on main webpage</p></figcaption></figure>

If we then copy / paste these into the [https://crackstation.net/](https://crackstation.net/) website we can see that the hashes are simply of consecutive numerical values.

<figure><img src="../../../../.gitbook/assets/image (4) (1) (2).png" alt=""><figcaption><p>Cracked hashes</p></figcaption></figure>

## Exploitation

We can then start trying other numerical values to see if they produce valid links. Use `-n` to ensure that the trailing newline is not outputted.&#x20;

```bash
echo -n '0' | md5sum
```

<figure><img src="../../../../.gitbook/assets/image (2) (1) (2).png" alt=""><figcaption><p>Calculate hash of <code>0</code></p></figcaption></figure>

We can use curl to request the new link and grep to check for a flag.&#x20;

```bash
curl $ip/cfcd208495d565ef66e7dff9f98764da | grep flag
```

<figure><img src="../../../../.gitbook/assets/image (7) (2).png" alt=""><figcaption><p>Finding the flag</p></figcaption></figure>
