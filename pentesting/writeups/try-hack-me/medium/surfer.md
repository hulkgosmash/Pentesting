# Surfer

<figure><img src="../../../../.gitbook/assets/6924475c1dc389f44b230968c782d984.png" alt=""><figcaption><p>Surfer</p></figcaption></figure>

## Summary

Woah, check out this radical app! Isn't it narly dude? We've been surfing through some webpages and we want to get you on board too! They said this application has some functionality that is only available for internal usage -- but if you catch the right wave, you can probably find the sweet stuff!

\


Access this challenge by deploying both the vulnerable machine by pressing the green "Start Machine" button located within this task, and the TryHackMe AttackBox by pressing the  "Start AttackBox" button located at the top-right of the page.

Navigate to the following URL using the AttackBox: [HTTP://10.10.18.226](http://10.10.18.226/)

Check out similar content on TryHackMe:

* [SSRF](https://tryhackme.com/room/ssrfqi)

## Enumeration



| Port   | State | Service | Version                         |
| ------ | ----- | ------- | ------------------------------- |
| 22/tcp | open  | ssh     | OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 |
| 80/tcp | open  | http    | Apache httpd 2.4.38             |

### Port 80 - Apache httpd 2.4.38

Navigating to the webpage shows us the login portal

<figure><img src="../../../../.gitbook/assets/image (21) (1).png" alt=""><figcaption><p>Login Portal</p></figcaption></figure>

A quick directory search finds the file [`http://10.10.18.226/backup/chat.txt`](http://10.10.18.226/backup/chat.txt)``

<figure><img src="../../../../.gitbook/assets/image (3) (2) (1).png" alt=""><figcaption><p><code></code><a href="http://10.10.18.226/backup/chat.txt"><code>http://10.10.18.226/backup/chat.txt</code></a><code></code></p></figcaption></figure>

Using the found information we login to the portal with admin / admin. Immediately a few things stand out. We can see the location of the flag `/internal/admin.php` and also an `Export to PDF` button.

<figure><img src="../../../../.gitbook/assets/image (17) (2).png" alt=""><figcaption><p>24X7 System+ console</p></figcaption></figure>

If we click on the `Export to PDF` button we can see the following.

<figure><img src="../../../../.gitbook/assets/image (6) (1) (2).png" alt=""><figcaption><p>Exported PDF Document</p></figcaption></figure>

If we navigate back to the console and set BurpSuite to intercept requests then click on the `Export to PDF` we see a request like the one below.&#x20;

<figure><img src="../../../../.gitbook/assets/image (1) (3).png" alt=""><figcaption><p>Original Request</p></figcaption></figure>

Modify the request as shown below to point to `/internal/admin.php`.

<figure><img src="../../../../.gitbook/assets/image (15) (1) (1).png" alt=""><figcaption><p>Modified Request</p></figcaption></figure>

Forward the request and the flag should be displayed in the browser.&#x20;

<figure><img src="../../../../.gitbook/assets/image (13) (2).png" alt=""><figcaption><p>flag</p></figcaption></figure>
