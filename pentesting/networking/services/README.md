# DNS

## Setup

Set Variable when domain is known `export domain=test.com`

## General Commands

<table><thead><tr><th width="345">Info</th><th>Command</th></tr></thead><tbody><tr><td>Banner Grab</td><td><code>dig version.bind CHAOS TXT @$ip</code></td></tr><tr><td>Try zone transfer without domain</td><td><code>dig axfr @$ip</code></td></tr><tr><td>Try zone transfer guessing the domain</td><td><code>dig axfr @$ip $domain</code></td></tr><tr><td>Regular DNS request</td><td><code>dig ANY @$ip $domain</code></td></tr><tr><td>Regular DNS request</td><td><code>dig A @$ip $domain</code></td></tr><tr><td>IPv6 DNS request</td><td><code>dig AAAA @$ip $domain</code></td></tr><tr><td>Get TXT Records</td><td><code>dig TXT @$ip $domain</code></td></tr><tr><td>Get MX Records</td><td><code>dig MX @$ip $domain</code></td></tr><tr><td>DNS that resolves that name</td><td><code>dig NS @$ip $domain</code></td></tr><tr><td>Reverse lookup</td><td><code>dig -x 192.168.0.2 @$ip</code></td></tr><tr><td>reverse IPv6 lookup</td><td><code>dig -x 2a00:1450:400c:c06::93 @$ip</code></td></tr><tr><td>dnsenum</td><td><code>dnsenum $domain</code></td></tr><tr><td>dnsrecon</td><td><code>dnsrecon -d $domain -t axfr</code></td></tr></tbody></table>

## Subdomains

`gobuster vhost -u $domain -w /usr/share/dirb/wordlists/big.txt`

## Automated scripts

<table><thead><tr><th width="272">Info</th><th>Module / Script</th></tr></thead><tbody><tr><td>Perform enumeration actions</td><td><code>auxiliary/gather/enum_dns #Perform enumeration actions</code></td></tr><tr><td>Perform enumeration actions</td><td><code>nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" $ip</code></td></tr></tbody></table>

## DNSRecon

<table><thead><tr><th width="319">Info</th><th>Command</th></tr></thead><tbody><tr><td>DNS reverse of all of the addresses</td><td><code>dnsrecon -r 127.0.0.0/24 -n $ip</code></td></tr><tr><td>DNS reverse of all of the addresses</td><td><code>dnsrecon -r 127.0.1.0/24 -n $ip</code></td></tr><tr><td>DNS reverse of all of the addresses</td><td><code>dnsrecon -r $ip/24 -n $ip</code></td></tr><tr><td>Zone transfer</td><td><code>dnsrecon -d $domain -a -n $ip</code></td></tr></tbody></table>
