# Filtering

## Basic

Show only HTTP traffic from a pcap file

```bash
tshark -Y 'http' -r HTTP_traffic.pcap
```

Show only the IP packets sent from 192.168.252.128 to 52.32.74.91

```bash
 tshark -r HTTP_traffic.pcap -Y "ip.src==192.168.252.128 && ip.dst==52.32.74.91"
```

Print only packets containing GET requests

```bash
tshark -r HTTP_traffic.pcap -Y "http.request.method==GET"
```

Print only packets only source IP and URL for all GET request packets

{% code overflow="wrap" %}
```bash
tshark -r HTTP_traffic.pcap -Y "http.request.method==GET" -Tfields -e frame.time -e ip.src -e http.request.full_uri
```
{% endcode %}

Show packets that contain the "password" string

```bash
tshark -r HTTP_traffic.pcap -Y "http contains password"
```

Show destination IP address for GET requests sent for New York Times

{% code overflow="wrap" %}
```bash
tshark -r HTTP_traffic.pcap -Y "http.request.method==GET && http.host==www.nytimes.com" -Tfields -e ip.dst
```
{% endcode %}

Show session ID being used by 192.168.252.128 for Amazon India store

{% code overflow="wrap" %}
```bash
tshark -r HTTP_traffic.pcap -Y "ip contains amazon.in && ip.src==192.168.252.128" -Tfields -e ip.src -e http.cookie
```
{% endcode %}

Show OS the machine on IP address 192.168.252.128 is using

{% code overflow="wrap" %}
```bash
tshark -r HTTP_traffic.pcap -Y "ip.src==192.168.252.128 && http" -Tfields -e http.user_agent
```
{% endcode %}

## Advanced

Show only SSL traffic

```bash
tshark -Y 'ssl' -r HTTPS_traffic.pcap
```

Show only the source IP and destination IP for all SSL handshake packets

```bash
tshark -r HTTPS_traffic.pcap -Y "ssl.handshake" -Tfields -e ip.src -e ip.dst
```

List issuer name for all SSL certificates exchanged

{% code overflow="wrap" %}
```bash
tshark -r HTTPS_traffic.pcap -Y "ssl.handshake.certificate" -Tfields -e x509sat.printableString
```
{% endcode %}

Print the IP addresses of all servers accessed over SSL

```bash
tshark -r HTTPS_traffic.pcap -Y "ssl && ssl.handshake.type==1" -Tfields -e ip.dst
```

Show IP addresses associated with Ask Ubuntu servers

```bash
tshark -r HTTPS_traffic.pcap -Y "ip contains askubuntu"
```

Show IP address of the user who interacted with with Ask Ubuntu servers

{% code overflow="wrap" %}
```bash
tshark -r HTTPS_traffic.pcap -Y "ip.dst==151.101.1.69 || ip.dst==151.101.193.69 || ip.dst==151.101.129.69 || ip.dst==151.101.65.69" -Tfields -e ip.src
```
{% endcode %}

Show DNS servers were used by the clients for domain name resolutions

```bash
tshark -r HTTPS_traffic.pcap -Y "dns && dns.flags.response==0" -Tfields -e ip.dst
```

Show IP addresses of machines running Avast

```bash
tshark -r HTTPS_traffic.pcap -Y "ip contains avast" -Tfields -e ip.src
```

## Wifi

Show only WiFi traffic

```bash
tshark -r WiFi_traffic.pcap -Y "wlan"
```

Show the deauthentication packets

```bash
tshark -r WiFi_traffic.pcap -Y "wlan.fc.type_subtype==0x000c"
```

Display WPA handshake packets

```bash
tshark -r WiFi_traffic.pcap -Y "eapol"
```

Show only the SSID and BSSID values for all beacon frames

{% code overflow="wrap" %}
```bash
tshark -r WiFi_traffic.pcap -Y "wlan.fc.type_subtype==8" -Tfields -e wlan.ssid -e wlan.bssid
```
{% endcode %}

Find the BSSID of SSID “LazyArtists”

```bash
tshark -r WiFi_traffic.pcap -Y "wlan.ssid==LazyArtists" -Tfields -e wlan.bssid
```

Show the channel SSID "Home\_Network" is operating on

{% code overflow="wrap" %}
```bash
tshark -r WiFi_traffic.pcap -Y "wlan.ssid==Home_Network" -Tfields -e wlan_radio.channel
```
{% endcode %}

Show the MAC addresses of devices that received the deauth messages

```bash
tshark -r WiFi_traffic.pcap -Y "wlan.fc.type_subtype==0x000c" -Tfields -e wlan.ra
```

Show which device MAC 5c:51:88:31:a0:3b belongs to

{% code overflow="wrap" %}
```bash
tshark -r WiFi_traffic.pcap -Y "wlan.ta==5c:51:88:31:a0:3b && http" -Tfields -e http.user_agent
```
{% endcode %}

## VOIP

Only show VoIP traffic

```bash
tshark -r VoIP_traffic.pcap -Y "sip or rtp"
```

Show all REGISTER packets

```bash
tshark -r VoIP_traffic.pcap -Y "sip.Method==REGISTER"
```

Show only the source IP, sender extension and authorization digest response for REGISTER packets

{% code overflow="wrap" %}
```bash
tshark -r VoIP_traffic.pcap -Y "sip.Method==REGISTER" -Tfields -e ip.src -e sip.from.user -e sip.auth.digest.response
```
{% endcode %}

Show all codecs being used by RTP protocol

```bash
tshark -r VoIP_traffic.pcap -Y "sdp" -Tfields -e sdp.media
```

Show IP address of the user who is using the Zoiper VoIP client

```bash
 tshark -r VoIP_traffic.pcap -Y "sip contains Zoiper" -Tfields -e ip.src
```

Show IP address of the SIP server used to place calls

```bash
tshark -r VoIP_traffic.pcap -Y "sip.Method==REGISTER" -Tfields -e ip.dst
```

Show content of the text message sent to +918108591527

```bash
tshark -r VoIP_traffic.pcap -Y "sip.Method == MESSAGE" -V
```

Show extensions that completed a call successfully

{% code overflow="wrap" %}
```bash
tshark -r VoIP_traffic.pcap -Y "sip.Method==BYE" -Tfields -e sip.from.user -e sip.to.user
```
{% endcode %}
