# Filtering

Show only HTTP traffic from a pcap file

```bash
tshark -Y 'http' -r HTTP_traffic.pcap
```

Show only the IP packets sent from 192.168.252.128 to 52.32.74.91

```bash
 tshark -r HTTP_traffic.pcap -Y "ip.src==192.168.252.128 && ip.dst==52.32.74.91"
```

Print only packets containing GET requests

```bash
tshark -r HTTP_traffic.pcap -Y "http.request.method==GET"
```

Print only packets only source IP and URL for all GET request packets

{% code overflow="wrap" %}
```bash
tshark -r HTTP_traffic.pcap -Y "http.request.method==GET" -Tfields -e frame.time -e ip.src -e http.request.full_uri
```
{% endcode %}

Show packets that contain the "password" string

```bash
tshark -r HTTP_traffic.pcap -Y "http contains password"
```

Show destination IP address for GET requests sent for New York Times

{% code overflow="wrap" %}
```bash
tshark -r HTTP_traffic.pcap -Y "http.request.method==GET && http.host==www.nytimes.com" -Tfields -e ip.dst
```
{% endcode %}

Show session ID being used by 192.168.252.128 for Amazon India store

{% code overflow="wrap" %}
```bash
tshark -r HTTP_traffic.pcap -Y "ip contains amazon.in && ip.src==192.168.252.128" -Tfields -e ip.src -e http.cookie
```
{% endcode %}

Show OS the machine on IP address 192.168.252.128 is using

{% code overflow="wrap" %}
```bash
tshark -r HTTP_traffic.pcap -Y "ip.src==192.168.252.128 && http" -Tfields -e http.user_agent
```
{% endcode %}

