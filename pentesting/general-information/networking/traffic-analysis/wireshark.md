# Wireshark

## Filters

<table><thead><tr><th width="295">Info</th><th>Command</th></tr></thead><tbody><tr><td>Source IP Address</td><td><code>ip.src == 192.168.1.1</code></td></tr><tr><td>Destination IP Address</td><td><code>ip.dst == 192.168.1.1</code></td></tr><tr><td>TCP Port</td><td><code>tcp.port == 22</code></td></tr><tr><td>UDP Port</td><td><code>udp.port == 67</code></td></tr><tr><td>HTTP GET Request</td><td><code>http.request.method == GET</code></td></tr><tr><td>HTTP POST Request</td><td><code>http.request.method == POST</code></td></tr><tr><td>Source &#x26; Destination Addresses</td><td><code>ip.src==192.168.0.0/16 and ip.dst==192.168.0.0/16</code></td></tr></tbody></table>

## Comparison Operators

| Info                     | Command                  |
| ------------------------ | ------------------------ |
| Equal                    | `ip.src == 10.10.10.100` |
| Not equal                | `ip.src != 10.10.10.100` |
| Greater than             | `ip.ttl > 250`           |
| Less than                | `ip.ttl < 10`            |
| Greater than or equal to | `ip.ttl >= 0xFA`         |
| Less than or equal to    | `ip.ttl <= 0xA`          |

## Logical Expressions

| Info        | Command                                                 |
| ----------- | ------------------------------------------------------- |
| Logical AND | `(ip.src == 10.10.10.100) AND (ip.src == 10.10.10.111)` |
| Logical OR  | `(ip.src == 10.10.10.100) OR (ip.src == 10.10.10.111)`  |
| Logical NOT | `!(ip.src == 10.10.10.222)`                             |

## IP Filters

<table><thead><tr><th width="453">Info</th><th width="287">Command</th></tr></thead><tbody><tr><td>Show all IP packets</td><td><code>ip</code></td></tr><tr><td>Show all packets containing IP addresses from 10.10.10.0/24 subnet.</td><td><code>ip.addr == 10.10.10.0/24</code></td></tr><tr><td>Show all packets originated from 10.10.10.111</td><td><code>ip.src == 10.10.10.111</code></td></tr><tr><td>Show all packets sent to 10.10.10.111</td><td><code>ip.dst == 10.10.10.111</code></td></tr></tbody></table>

**The ip.addr filters the traffic without considering the packet direction. The ip.src/ip.dst filters the packet depending on the packet direction.**

## TCP and UDP Filters

<table><thead><tr><th>Info</th><th width="279">Command</th></tr></thead><tbody><tr><td>Show all TCP packets with port 80</td><td><code>tcp.port == 80</code></td></tr><tr><td>Show all TCP packets originating from port 1234</td><td><code>tcp.srcport == 1234</code></td></tr><tr><td>Show all TCP packets sent to port 80</td><td><code>tcp.dstport == 80</code></td></tr><tr><td>Show all UDP packets with port 53</td><td><code>udp.port == 53</code></td></tr><tr><td>Show all UDP packets originating from port 1234</td><td><code>udp.srcport == 1234</code></td></tr><tr><td>Show all UDP packets sent to port 535</td><td><code>udp.dstport == 5353</code></td></tr></tbody></table>

## Application Level Protocol Filters | HTTP and DNS

<table><thead><tr><th>Info</th><th width="323">Command</th></tr></thead><tbody><tr><td>Show all HTTP packets</td><td><code>http</code></td></tr><tr><td>Show all packets with HTTP response code "200"</td><td><code>http.response.code == 200</code></td></tr><tr><td>Show all HTTP GET requests</td><td><code>http.request.method == "GET"</code></td></tr><tr><td>Show all HTTP POST requests</td><td><code>http.request.method == "POST"</code></td></tr><tr><td>Show all DNS packets</td><td><code>dns</code></td></tr><tr><td>Show all DNS requests</td><td><code>dns.flags.response == 0</code></td></tr><tr><td>Show all DNS responses</td><td><code>dns.flags.response == 1</code></td></tr><tr><td>Show all DNS "A" records</td><td><code>dns.qry.type == 1</code></td></tr></tbody></table>
