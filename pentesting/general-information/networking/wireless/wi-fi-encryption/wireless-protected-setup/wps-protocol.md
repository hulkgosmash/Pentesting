# WPS Protocol

The WPS protocol varies based on the different possible scenarios. We will only address the most common scenario where the enrolee uses WPS PIN on a standalone AP. Detailed protocols of other possible scenarios can be found in the Wi-Fi Simple Configuration technical specification.

<figure><img src="../../../../../../.gitbook/assets/image.png" alt=""><figcaption><p>Setup using a standalone AP/Registrar</p></figcaption></figure>

In Figure 16, the first step is the discovery where the enrolee queries the AP with a Wi-Fi Simple Configuration Information Element (IE) in the probe request. If it responds positively, the device will do the usual authentication and association process then proceed to initiate the 802.1X process and respond with a **WFA-SimpleConfig-Enrollee-1-0** identity. The enrolee gets provisioned after the exchange of message M1 to M8. Finally, the device gets disconnected from the AP and reconnects with the credentials received earlier.

The M1 and M2 messages may be exchanged while waiting for the user to input the enrolee device password from the device in the AP interface.

When using an external registrar and/or push button, the communication between the enrolee and the AP is essentially the same as what was described above. Communication between the AP and registrar is what differs.

Once we reach M5, we know the first half of the PIN. If we receive a NACK after M6, the second half is incorrect.
