# Mesh Networks

Let's continue to build on our understanding of networks by discussing _Mesh Networks_. The coverage for a typical Wi-Fi network is limited by the APs. Additional APs can be added to increase coverage, but they need to be close to a network socket. This can be a problem in large indoor environments such as warehouses, outdoor areas like campuses, or historically protected monuments and buildings where we can't drill holes to run network cables from one AP to the next.

Mesh networks can be a good solution in these cases. They can be configured using existing equipment and technologies. Additional access points are added to the infrastructure to determine the best "signal path" for a station on the network. In this case, additional APs act as both a client (to the AP they are repeating) and also as an AP to further repeat the signal. 802.11s is an amendment of 802.11 to standardize mesh networking.

One could create a mesh network by using Ad-Hoc mode. In this case, the setup is fairly complex and requires additional software to handle packet routing across nodes using protocols such as AODV, BATMAN, or OSLR. On the other hand, 802.11s was designed for networks up to 32 nodes, with a default routing protocol called Hybrid Wireless Mesh Protocol (HWMP).

A variety of vendors provide mesh-type solutions, but because their protocols are proprietary, they are neither interoperable nor compatible with 802.11s.

In addition to the similarities with infrastructure networks, 802.11s adds the following device classes:

* _Mesh Point (MP)_: Devices that establish a link between mesh devices. These can be either Mesh Portals, Mesh APs, or even other Mesh Points.
* _Mesh AP (MAP)_: Devices that have the functionality of a Mesh Point and an Access Point.
* _Mesh Portal (MPP)_: Devices that provide a link between the wired network and the wireless network.

We can see a few of these acronyms being used in the diagram of a Mesh Network below.

<figure><img src="../../../../../.gitbook/assets/image (31).png" alt=""><figcaption><p>Mesh network diagram</p></figcaption></figure>

The red links represent the mesh radio links and the blue links represent the wireless connections with stations. For example, the tablet with the stylus may communicate with the nearest MAP, but depending on a number of factors, those packets may take one of several routes to the DS.

In addition to the functionality we've described here, we need to consider that devices in wireless networks sometimes move or disappear, so the path a packet takes will not be always the same. The path is dynamically generated by software that takes various changing parameters into account such as signal quality, noise, rate, response time, or distance between nodes.

Since Mesh is peer-to-peer (P2P), mesh devices have to handle neighbour discovery, connecting to peers, and security between each other. After discovering neighbour MAPs, they start the peering. The connection is maintained as long as both devices are in range and continue to respond to frames.

There are two peering modes available:

* _Mesh Peering Management (MPM)_: Unsecure peering
* _Authenticated Mesh Peering Exchange (AMPE)_: Secure peering

MPM is unencrypted and rogue stations may hijack connections.

AMPE, the encrypted protocol, uses either Simultaneous Authentication of Equals (SAE) or 802.1X to exchange encryption keys. SAE is a password-based authentication mechanism whereas 802.1X uses an authentication server. Although 802.1X is stronger than SAE, it uses an authentication server and, depending on the status of the 802.1X network, there may not be a path to the authentication server, or the path may become broken.
