# Advanced Firewall Rules

Display rules with line numbers

```bash
sudo iptables -L --line-numberss
```

Drop all INPUT traffic to the 192.168.1.0/24 subnet and set the rule on line 2

```bash
sudo iptables -R INPUT 2 -s 192.168.1.0/24 -j DROP
```

Allow the host 192.168.1.37 to INPUT traffic on port 8080 to the local host and set the rule on line 1

```bash
sudo iptables -R INPUT 1 -s 192.168.1.37 -d 127.0.0.1 -p tcp --dport 8080
```

Any packet part of an existing connection will be tracked and allowed as the first rule

```bash
sudo iptables -I INPUT 1 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
```

Any INVALID packet is dropped on the INPUT chain

```bash
sudo iptables -I INPUT 2 -m conntrack --ctstate INVALID -j DROP
```
