# Registry

**HKEY\_CLASSES\_ROOT (HKCR)**: Provides information related to file types and properties. The subkeys under HKCR are often used by shell applications (such as the Command Prompt) and by _Component Object Model_ (COM)[5](https://portal.offensive-security.com/courses/soc-100/books-and-videos/modal/modules/windows-basics-ii/windows-registry/windows-registry-overview#fn5) applications.

**HKEY\_CURRENT\_CONFIG (HKCC)**: Provides information related to the hardware configurations upon which the OS is running, specifically in comparison to the default configuration.

**HKEY\_CURRENT\_USER (HKCU)**: Provides information related to the setting configurations of the current user. Note that the HKCU key and subkeys will be different depending on what user is logged in, including SYSTEM.

**HKEY\_LOCAL\_MACHINE**: Provides information about the local machine related to input/output devices, memory, and drivers.

**HKEY\_PERFORMANCE\_DATA**: Provides information related to system performance. Notably, data associated with this key isn't stored within the Registry itself but is rather referenced by _Registry functions_[6](https://portal.offensive-security.com/courses/soc-100/books-and-videos/modal/modules/windows-basics-ii/windows-registry/windows-registry-overview#fn6).

**HKEY\_USERS** Provides information related to the default settings assigned to new users.

Using reg query on Run and RunOnce keys

```powershell
reg query hkcu\software\microsoft\windows\currentversion\runonce
reg query hkcu\software\microsoft\windows\currentversion\run
```

Using reg delete

```powershell
reg delete hkcu\software\microsoft\windows\currentversion\run /va
```

Using reg add

{% code overflow="wrap" %}
```powershell
reg add hkcu\software\microsoft\windows\currentversion\run /v OneDrive /t REG_SZ /d "C:\Users\Offsec\AppData\Local\Microsoft\OneDrive\OneDrive.exe"
```
{% endcode %}

Using reg export

```powershell
reg export hkcu\environment environment
```
