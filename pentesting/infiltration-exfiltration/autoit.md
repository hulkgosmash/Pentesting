# AutoIt

## Installation

1. Download the latest release from [https://www.autoitscript.com/site/autoit/downloads/](https://www.autoitscript.com/site/autoit/downloads/)
2.  Click next.&#x20;

    <figure><img src="../../.gitbook/assets/image (4) (5).png" alt=""><figcaption></figcaption></figure>


3.  Click `I Agree`

    <figure><img src="../../.gitbook/assets/image (8) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>


4.  Leave as default and click `Next`

    <figure><img src="../../.gitbook/assets/image (1) (1) (4).png" alt=""><figcaption></figcaption></figure>


5.  Leave as default and click `next`

    <figure><img src="../../.gitbook/assets/image (1) (8).png" alt=""><figcaption></figcaption></figure>


6.  Leave as default and click `next`

    <figure><img src="../../.gitbook/assets/image (2) (7).png" alt=""><figcaption></figcaption></figure>


7.  Click on `Install`

    <figure><img src="../../.gitbook/assets/image (5) (4).png" alt=""><figcaption></figcaption></figure>


8.  Once completed disable `Show release notes` then click then `Finish`&#x20;

    <figure><img src="../../.gitbook/assets/image (3) (6).png" alt=""><figcaption></figcaption></figure>

## Create AutoIt Script

{% code overflow="wrap" %}
```powershell
# Read in a binary file (Change the path here if you like)
$bytes = [System.IO.File]::ReadAllBytes("C:\temp\Windows_AFD_LPE_CVE-2023-21768.exe")
# Convert to base64
$base64 = [System.Convert]::ToBase64String($bytes)
# This is the maximum line size that AutoIt appears to support. 
$chunkSize = 4084
# Dunno but ChatGPT told me it would work and it seems to. 
$numChunks = [Math]::Ceiling($base64.Length / $chunkSize)
# Add a sleep statement to the start of the script so you have time to click on the destination before it starts typing. 
$autoit_script = "Sleep(5000)`n"
for ($i = 0; $i -lt $numChunks; $i++) {
    $startIndex = $i * $chunkSize
    $chunk = $base64.Substring($startIndex, [Math]::Min($chunkSize, $base64.Length - $startIndex))
    $autoit_script += 'Send("' + $chunk + '",1)' + "`n"
}
# Output the file as a AutoIt script. 
$autoit_script | Out-File C:\temp\exploit.au3
# On the destination server in PowerShell do the following. 
# From notepad or wherever you had AutoIt type the string select all text and copy to the clipboard. 
# Type the below string into PowerShell and paste the base64 text in the clipboard in between the single quotes. 
$base64String = ''
# Run this to convert from base64 back to binary
$bytes = [System.Convert]::FromBase64String($base64String)
# Write the file to disk (Change the path if you like)
[System.IO.File]::WriteAllBytes("C:\temp\exploit.exe", $bytes)
```
{% endcode %}
