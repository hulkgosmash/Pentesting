# Methodology

## No Credentials

### Scan Network

```bash
# Enumerate SMB Hosts
cme smb $iprange
# Ping scan
nmap -sP -p $ip
# Quick Scan
nmap -PN -sV --top-ports 50 --open $ip
# Search SMB vulnerabilities
nmap -PN --script smb-vuln* -p139,445 $ip
# Classic Scan
nmap -PN -sC -sV $ip
# Full Scan
nmap -PN -sC -sV -p- $ip
# UDP Scan
nmap -sU -sC -sV $ip
```

### Find AD IP

```bash
nslookup -type=SRV _ldap._tcp.dc._msdcs.//$domain/
```

### Zone Transfer

```bash
dig axfr $domain @$nameserver
```

### List guest access on SMB share

```bash
enum4linux -a -u "" -p "" $dcip && enum4linux -a -u "guest" -p "" $dcip
smbmap -u "" -p "" -P 445 -H $dcip && smbmap -u "guest" -p "" -P 445 -H $dcip
smbclient -U '%' -L //$dcip && smbclient -U 'guest%' -L //$dcip
# Enumerate NULL session
cme smb $dcip -u '' -p ''
# Enumerate anonymous access
cme smb $dcip -u 'a' -p ''
```

### Enumerate LDAP

```bash
nmap -n -sV --script "ldap* and not brute" -p 389 $dcip
ldapsearch -x -h $ip -s base
```

### Find user list

```
enum4linux -U $dcip | grep 'user:'
cme smb $dcip -u 
```
